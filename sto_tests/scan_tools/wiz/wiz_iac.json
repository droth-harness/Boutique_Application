{"id":"8001a31d-f3c1-4e18-af32-20480521522d","projects":null,"createdAt":"2024-08-06T19:07:42.402842239Z","startedAt":"0001-01-01T00:00:00Z","createdBy":{"serviceAccount":{"id":"mlipebtwsndhxdmnzdwrxzmiolancw57lijvg4vak6cxsrj6nwvxg"}},"status":{"state":"SUCCESS","verdict":"PASSED_BY_POLICY"},"policies":[{"id":"53046620-8413-4dcf-98c2-2df3efcb8ba2","name":"Default IaC policy","description":"Default built-in policy for Infrastructure as Code scanning","type":"IAC","builtin":true,"projects":null,"policyLifecycleEnforcements":[{"enforcementMethod":"AUDIT","deploymentLifecycle":"ADMISSION_CONTROLLER"},{"enforcementMethod":"BLOCK","deploymentLifecycle":"CLI"}],"ignoreRules":null,"lifecycleTargets":null,"Default":false,"params":{"__typename":"cicdscanpolicyparamsiac","severityThreshold":"CRITICAL","countThreshold":1,"ignoredRules":null,"validatableIgnoredRules":null,"builtinIgnoreTagsEnabled":false,"customIgnoreTags":null,"securityFrameworks":null}},{"id":"1a4b47b2-7655-4f23-b9e6-88ebab0f9a05","name":"Default secrets policy","description":"Default built-in policy for secret scanning","type":"SECRETS","builtin":true,"projects":null,"policyLifecycleEnforcements":[{"enforcementMethod":"AUDIT","deploymentLifecycle":"CLI"}],"ignoreRules":null,"lifecycleTargets":null,"Default":false,"params":{"__typename":"cicdscanpolicyparamssecrets","countThreshold":1,"pathAllowList":[]}}],"extraInfo":null,"tags":null,"outdatedPolicies":[],"taggedResource":null,"scanOriginResource":{"__typename":"CICDScanOriginIAC","name":"IAC scan 2024-08-06T19:07:23Z","subTypes":["CLOUD_FORMATION","AZURE_RESOURCE_MANAGER","TERRAFORM"]},"result":{"__typename":"CICDIACScanResult","failedPolicyMatches":[],"ruleMatches":[{"rule":{"id":"821a3118-d1ad-4a45-8d8f-d8fcecb3ac3d","name":"Disabled KMS key should be safely deleted"},"severity":"INFORMATIONAL","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myKey.Properties.PendingWindowInDays","fileName":"/harness/KaiMonkey/cft/misc/kms-key/deploy.yml","lineNumber":8,"matchContent":"      PendingWindowInDays: 100","expected":"'Resources.myKey.Properties.PendingWindowInDays' should be undefined","found":"'Resources.myKey.Properties.PendingWindowInDays' is defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"5cdd6920-4c72-4c67-b9ae-0457d9b7ec85","name":"EC2 Not EBS Optimized"},"severity":"INFORMATIONAL","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_instance[km_vm]","fileName":"/harness/KaiMonkey/terraform/aws/modules/compute/main.tf","lineNumber":124,"matchContent":"resource \"aws_instance\" \"km_vm\"{","expected":"'aws_instance[km_vm].ebs_optimized' should be defined and set to true","found":"'aws_instance[km_vm].ebs_optimized' is undefined","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_instance\" \"example_instance\" {\n  ebs_optimized = true\n}","fileRemediation":null}]},{"rule":{"id":"2b6183f7-c3b0-4c49-ab18-b82596d23885","name":"EC2 instance tenancy is not dedicated"},"severity":"INFORMATIONAL","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_instance[km_vm]","fileName":"/harness/KaiMonkey/terraform/aws/modules/compute/main.tf","lineNumber":124,"matchContent":"resource \"aws_instance\" \"km_vm\"{","expected":"'tenancy' field should not be set to 'default'","found":"'tenancy' field is set to 'default'","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_instance\" \"example_instance\" {\n  tenancy = \"dedicated\"\n}","fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_instance[web-app-instance]","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":292,"matchContent":"resource \"aws_instance\" \"web-app-instance\" {","expected":"'tenancy' field should not be set to 'default'","found":"'tenancy' field is set to 'default'","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_instance\" \"example_instance\" {\n  tenancy = \"dedicated\"\n}","fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_instance[privileged-instance]","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":369,"matchContent":"resource \"aws_instance\" \"privileged-instance\" {","expected":"'tenancy' field should not be set to 'default'","found":"'tenancy' field is set to 'default'","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_instance\" \"example_instance\" {\n  tenancy = \"dedicated\"\n}","fileRemediation":null}]},{"rule":{"id":"dc61ba98-dbae-44d1-ac9c-ba119a8f1e64","name":"S3 Bucket set to host websites"},"severity":"INFORMATIONAL","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.S3Bucket.Properties","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":8,"matchContent":"      WebsiteConfiguration:","expected":"'Resources.S3Bucket.Properties.WebsiteConfiguration' should not be defined","found":"'Resources.S3Bucket.Properties.WebsiteConfiguration' is defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e66ab5de-f7f0-4f33-87b8-8a2d96bf01e0","name":"API Gateway stages access logging should be enabled"},"severity":"LOW","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.Prod.Properties","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-method-settings/deploy.yml","lineNumber":4,"matchContent":"    Properties:","expected":"Resources.Prod.Properties.AccessLogSettings or Resources.%!s(MISSING).Properties.DefaultRouteSettings should be defined and not null","found":"Resources.Prod.Properties.AccessLogSettings and Resources.%!s(MISSING).Properties.DefaultRouteSettings are undefined or null","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.Prod.Properties","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-stage/deploy.json","lineNumber":9,"matchContent":"      \"Properties\": {","expected":"Resources.Prod.Properties.AccessLogSettings or Resources.%!s(MISSING).Properties.DefaultRouteSettings should be defined and not null","found":"Resources.Prod.Properties.AccessLogSettings and Resources.%!s(MISSING).Properties.DefaultRouteSettings are undefined or null","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"b408bbfe-1d4e-4f3b-913f-0a0509a95b42","name":"Access keys should be rotated every 365 days"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ConfigRuleForVolumeTags","fileName":"/harness/KaiMonkey/cft/config/config-configrule/deploy.json","lineNumber":5,"matchContent":"    \"ConfigRuleForVolumeTags\": {","expected":"Resources.ConfigRuleForVolumeTags should have a ConfigRule defining rotation period on AccessKeys.","found":"Resources.ConfigRuleForVolumeTags doesn't have a ConfigRule defining rotation period on AccessKeys.","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e02567fe-6d83-4fca-83fc-066adf7f6841","name":"Access keys should be rotated every 90 days"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ConfigRuleForVolumeTags","fileName":"/harness/KaiMonkey/cft/config/config-configrule/deploy.json","lineNumber":5,"matchContent":"    \"ConfigRuleForVolumeTags\": {","expected":"Resources.ConfigRuleForVolumeTags should have a ConfigRule defining rotation period on AccessKeys.","found":"Resources.ConfigRuleForVolumeTags doesn't have a ConfigRule defining rotation period on AccessKeys.","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"d6d3b8f7-740c-414b-8713-b45a2aca10cd","name":"CloudFront web distribution geo restriction should be enabled"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.cloudFrontDistribution.Properties.Restrictions.GeoRestriction.RestrictionType","fileName":"/harness/KaiMonkey/cft/misc/cloudfront-distribution/deploy.json","lineNumber":91,"matchContent":"                            \"RestrictionType\": \"none\"","expected":"Resources.cloudFrontDistribution.Properties.Restrictions.GeoRestriction.RestrictionType should be enabled with whitelist or blacklist","found":"Resources.cloudFrontDistribution.Properties.Restrictions.GeoRestriction.RestrictionTypeallows is configured with none. Therefore, Geo Restriction is not enabled and it should be","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"eb14c32e-1e29-4ed2-895f-341f336601d2","name":"CloudTrail event should be integrated with CloudWatch"},"severity":"LOW","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myTrail.Properties","fileName":"/harness/KaiMonkey/cft/misc/cloudtrail/deploy.json","lineNumber":6,"matchContent":"      \"Properties\": {","expected":"'Resources.myTrail.Properties.CloudWatchLogsLogGroupArn' should be declared","found":"'Resources.myTrail.Properties.CloudWatchLogsLogGroupArn' is not declared","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.myTrail.Properties","fileName":"/harness/KaiMonkey/cft/misc/cloudtrail/deploy.json","lineNumber":6,"matchContent":"      \"Properties\": {","expected":"'Resources.myTrail.Properties.CloudWatchLogsRoleArn' should be declared","found":"'Resources.myTrail.Properties.CloudWatchLogsRoleArn' is not declared","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"8a1cce1c-d0b5-420a-8a31-1ddd648d215f","name":"CloudTrail log file validation should be enabled"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myTrail.Properties.EnableLogFileValidation","fileName":"/harness/KaiMonkey/cft/misc/cloudtrail/deploy.json","lineNumber":11,"matchContent":"        \"EnableLogFileValidation\": false","expected":"'Resources.myTrail.Properties.EnableLogFileValidation' should be true","found":"'Resources.myTrail.Properties.EnableLogFileValidation' is not true","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"4b9ff4a2-5cbf-4509-ae9a-531998a6b4a2","name":"CloudTrail trail should be associated with an SNS topic"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myTrail.Properties","fileName":"/harness/KaiMonkey/cft/misc/cloudtrail/deploy.json","lineNumber":6,"matchContent":"      \"Properties\": {","expected":"'Resources.myTrail.Properties.SnsTopicName' should be set","found":"'Resources.myTrail.Properties.SnsTopicName' is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"2c1e8e28-978a-446a-9fae-0087654191dd","name":"CloudTrail trail status should be logging"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myTrail.Properties.IsLogging","fileName":"/harness/KaiMonkey/cft/misc/cloudtrail/deploy.json","lineNumber":8,"matchContent":"        \"IsLogging\": false,","expected":"'Resources.myTrail.Properties.IsLogging' should be true","found":"'Resources.myTrail.Properties.IsLogging' is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ada5b978-4996-405d-8fd1-dad306eaf4f8","name":"Database instance copy tags to snapshots should be enabled"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_db_instance[km_db]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":45,"matchContent":"resource \"aws_db_instance\" \"km_db\" {","expected":"'aws_db_instance[km_db].copy_tags_to_snapshot' should be defined and 'true'.","found":"'aws_db_instance[km_db].copy_tags_to_snapshot' is undefined or 'false'.","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"a2827af6-5b6f-4855-acf3-e4938c189c9d","name":"EBS volume should be attached to an EC2 instance"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.NewVolume","fileName":"/harness/KaiMonkey/cft/ec2/ebs-volume/deploy.json","lineNumber":4,"matchContent":"    \"NewVolume\": {","expected":"'Resources.NewVolume' should be attached to instances","found":"'Resources.NewVolume' is not attached to instances","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"849fe167-36f8-4332-b7d4-542c25193f61","name":"EC2 Instance detailed monitoring should be enabled"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_instance[km_vm]","fileName":"/harness/KaiMonkey/terraform/aws/modules/compute/main.tf","lineNumber":124,"matchContent":"resource \"aws_instance\" \"km_vm\"{","expected":"'aws_instance[km_vm].monitoring' should be set to true","found":"'aws_instance[km_vm].monitoring' is undefined","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_instance\" \"example_instance\" {\n  monitoring = true\n}","fileRemediation":null}]},{"rule":{"id":"ab41dc5f-c9ef-4af7-b27f-7ae1186c3f2d","name":"EC2 Security Group outbound rules should not allow all protocols"},"severity":"LOW","failedResourceCount":4,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[km_alb_sg].egress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":121,"matchContent":"  egress {","expected":"Security Group outbound rule should not allow all protocols","found":"aws_security_group[km_alb_sg] egress rule allows all protoclos ('all', '-1')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[km_ecs_sg].egress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":144,"matchContent":"  egress {","expected":"Security Group outbound rule should not allow all protocols","found":"aws_security_group[km_ecs_sg] egress rule allows all protoclos ('all', '-1')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[km_rds_sg].egress","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":27,"matchContent":"  egress {","expected":"Security Group outbound rule should not allow all protocols","found":"aws_security_group[km_rds_sg] egress rule allows all protoclos ('all', '-1')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].egress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":228,"matchContent":"  egress {","expected":"Security Group outbound rule should not allow all protocols","found":"aws_security_group[web-app-security-group] egress rule allows all protoclos ('all', '-1')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"a13caffe-56e8-478b-b4ea-b98b1be10352","name":"EC2 Security Group rules should have descriptions"},"severity":"LOW","failedResourceCount":12,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.NoDescription.Properties","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":23,"matchContent":"    Properties:","expected":"Resources.NoDescription.Properties.GroupDescription should be set","found":"Resources.NoDescription.Properties.GroupDescription is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.NoDescription.Properties.SecurityGroupIngress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":26,"matchContent":"        SecurityGroupIngress:","expected":"Resources.NoDescription.Properties.SecurityGroupIngress[0].Description should be set","found":"Resources.NoDescription.Properties.SecurityGroupIngress[0].Description is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.NoDescription.Properties.SecurityGroupEgress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":31,"matchContent":"        SecurityGroupEgress:","expected":"Resources.NoDescription.Properties.SecurityGroupEgress[0].Description should be set","found":"Resources.NoDescription.Properties.SecurityGroupEgress[0].Description is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[{{km_alb_sg}}].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":107,"matchContent":"  ingress {","expected":"aws_security_group[{{km_alb_sg}}].ingress.description should be defined and not null","found":"aws_security_group[{{km_alb_sg}}].ingress.description is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[{{km_alb_sg}}].egress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":121,"matchContent":"  egress {","expected":"aws_security_group[{{km_alb_sg}}].egress.description should be defined and not null","found":"aws_security_group[{{km_alb_sg}}].egress.description is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[{{km_ecs_sg}}].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":137,"matchContent":"  ingress {","expected":"aws_security_group[{{km_ecs_sg}}].ingress.description should be defined and not null","found":"aws_security_group[{{km_ecs_sg}}].ingress.description is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[{{km_ecs_sg}}].egress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":144,"matchContent":"  egress {","expected":"aws_security_group[{{km_ecs_sg}}].egress.description should be defined and not null","found":"aws_security_group[{{km_ecs_sg}}].egress.description is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[{{km_rds_sg}}]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":10,"matchContent":"resource \"aws_security_group\" \"km_rds_sg\" {","expected":"aws_security_group[{{km_rds_sg}}].description should be defined and not null","found":"aws_security_group[{{km_rds_sg}}].description is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[{{km_rds_sg}}].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":19,"matchContent":"  ingress {","expected":"aws_security_group[{{km_rds_sg}}].ingress.description should be defined and not null","found":"aws_security_group[{{km_rds_sg}}].ingress.description is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[{{km_rds_sg}}].egress","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":27,"matchContent":"  egress {","expected":"aws_security_group[{{km_rds_sg}}].egress.description should be defined and not null","found":"aws_security_group[{{km_rds_sg}}].egress.description is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[{{web-app-security-group}}].egress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":228,"matchContent":"  egress {","expected":"aws_security_group[{{web-app-security-group}}].egress.description should be defined and not null","found":"aws_security_group[{{web-app-security-group}}].egress.description is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[{{web-app-security-group}}].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[{{web-app-security-group}}].ingress.description should be defined and not null","found":"aws_security_group[{{web-app-security-group}}].ingress.description is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"83bc3abd-de90-4d8a-ad89-ebfe5cf7267c","name":"EC2 Security Group should not allow access to all ports"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Security Group inbound rule should restrict access","found":"aws_security_group[web-app-security-group] ingress rule allows unrestricted access to all ports","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"5fbab8f2-cc82-4fc6-9910-a76586199bbe","name":"ECS Container HealthCheck should be configured"},"severity":"LOW","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.taskdefinition.Properties.ContainerDefinitions","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":39,"matchContent":"            \"Name\": {","expected":"'Resources.taskdefinition.Properties.ContainerDefinitions' should contain 'HealthCheck' property","found":"'Resources.taskdefinition.Properties.ContainerDefinitions' doesn't contain 'HealthCheck' property","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.taskdefinition.Properties.ContainerDefinitions","fileName":"/harness/KaiMonkey/cft/ecs/ecs-task-definition/deploy.yml","lineNumber":7,"matchContent":"          Name:","expected":"'Resources.taskdefinition.Properties.ContainerDefinitions' should contain 'HealthCheck' property","found":"'Resources.taskdefinition.Properties.ContainerDefinitions' doesn't contain 'HealthCheck' property","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.taskdefinition.Properties.ContainerDefinitions","fileName":"/harness/KaiMonkey/cft/ecs/ecs-task-definition/deploy.yml","lineNumber":31,"matchContent":"          Name: \"busybox\"","expected":"'Resources.taskdefinition.Properties.ContainerDefinitions' should contain 'HealthCheck' property","found":"'Resources.taskdefinition.Properties.ContainerDefinitions' doesn't contain 'HealthCheck' property","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"f799480c-1c4e-4f51-b122-467ad667bd31","name":"IAM Group should contain users"},"severity":"LOW","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.group","fileName":"/harness/KaiMonkey/cft/iam/group/deploy.yml","lineNumber":3,"matchContent":"  group:","expected":"Resources.group has at least one user","found":"Resources.group does not have at least one user","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.RootGroup","fileName":"/harness/KaiMonkey/cft/iam/iam-group-policy/iam-group-policy.yml","lineNumber":3,"matchContent":"  RootGroup:","expected":"Resources.RootGroup has at least one user","found":"Resources.RootGroup does not have at least one user","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"af8919ea-aae4-471c-911d-0d031da40605","name":"IAM User should be part of a group"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.CFNUser.Properties","fileName":"/harness/KaiMonkey/cft/iam/iam-user/deploy.yml","lineNumber":4,"matchContent":"    Properties:","expected":"'Resources.Properties should contain Groups","found":"'Resources.Properties' does not contain Groups","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"03858897-5e3a-4dd4-904f-d909f5109732","name":"IAM User should be required to reset the password"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.CFNUser.Properties.LoginProfile.PasswordResetRequired","fileName":"/harness/KaiMonkey/cft/iam/iam-user/deploy.yml","lineNumber":7,"matchContent":"         PasswordResetRequired: false","expected":"'Resources.CFNUser.Properties.LoginProfile.PasswordResetRequired' should be configured as true","found":"'Resources.CFNUser.Properties.LoginProfile.PasswordResetRequired' is configured as false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"6a849efa-2e9a-45f8-ba3c-be3f3fe470cd","name":"IAM User should not have any policies attached"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.CFNUser.Properties.Policies","fileName":"/harness/KaiMonkey/cft/iam/iam-user/deploy.yml","lineNumber":8,"matchContent":"      Policies:","expected":"'Resources.CFNUser.Properties.Policies' should be undefined or empty","found":"'Resources.CFNUser.Properties.Policies' is not empty","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"d606ebc3-4201-478c-a27b-8757360afeb2","name":"IAM password policy should enforce minimum length of 14 "},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.CFNUser.Properties.LoginProfile.Password","fileName":"/harness/KaiMonkey/cft/iam/iam-user/deploy.yml","lineNumber":6,"matchContent":"         Password: 'Password'","expected":"'Resources.Properties.LoginProfile.Password' has a minimum length of 14","found":"'Resources.Properties.LoginProfile.Password' doesn't have a minimum length of 14","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"b9457670-18bb-42ba-8ffb-9c82bb878ab2","name":"IAM password policy should require at least one number"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.CFNUser.Properties.LoginProfile.Password","fileName":"/harness/KaiMonkey/cft/iam/iam-user/deploy.yml","lineNumber":6,"matchContent":"         Password: 'Password'","expected":"'Resources.Properties.LoginProfile.Password' should contain number","found":"'Resources.Properties.LoginProfile.Password' doesn't contain number","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"61b49f51-387e-4968-b82c-ef4c278ce76e","name":"IAM password policy should require at least one symbol"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.CFNUser.Properties.LoginProfile.Password","fileName":"/harness/KaiMonkey/cft/iam/iam-user/deploy.yml","lineNumber":6,"matchContent":"         Password: 'Password'","expected":"'Resources.Properties.LoginProfile.Password' should contain symbol","found":"'Resources.Properties.LoginProfile.Password' doesnt contain symbol","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3c9750b5-4788-43ed-a3ee-5fc8a0e71bc5","name":"KMS key policy should not allow all KMS actions"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myKey.Properties.KeyPolicy","fileName":"/harness/KaiMonkey/cft/misc/kms-key/deploy.yml","lineNumber":10,"matchContent":"      KeyPolicy:","expected":"Resources.myKey.Properties.KeyPolicy.Statement should not have wildcard in 'Action' and 'Principal'","found":"Resources.myKey.Properties.KeyPolicy.Statement has wildcard in 'Action' and 'Principal'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e04038a3-1347-4f6a-997e-12e6a0da89ea","name":"Lambda function should have a dead letter queue"},"severity":"LOW","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.fun.Properties","fileName":"/harness/KaiMonkey/cft/lambda/function/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"'Resources.fun.Properties.DeadLetterConfig' should be defined and not null","found":"'Resources.fun.Properties.DeadLetterConfig' is undefined or null","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.serverless.Properties","fileName":"/harness/KaiMonkey/cft/serverless/function/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"'Resources.serverless.Properties.DeadLetterConfig' should be defined and not null","found":"'Resources.serverless.Properties.DeadLetterConfig' is undefined or null","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"7526cdf6-56cf-4551-81ee-2fa7cc08396f","name":"Lambda function x-ray tracing should be enabled"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.serverless.Properties.Tracing","fileName":"/harness/KaiMonkey/cft/serverless/function/deploy.yml","lineNumber":14,"matchContent":"      Tracing: Passive","expected":"'Tracing' should be set to 'Active'","found":"'Tracing' is set to 'Passive'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"42d1a257-3fc3-4698-83a2-ac44756a7c37","name":"MSK Cluster logging should be enabled"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.muskluster.Properties","fileName":"/harness/KaiMonkey/cft/msk/cluster/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"Resources.muskluster.Properties.LoggingInfo should be defined","found":"Resources.muskluster.Properties.LoggingInfo is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"93587c05-f0c6-47ba-a108-5d86bfde5c76","name":"Private ECR Repository should scan images on push"},"severity":"LOW","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ecrepo.Properties.ImageScanningConfiguration.ScanOnPush","fileName":"/harness/KaiMonkey/cft/ecr/repository/deploy.yml","lineNumber":7,"matchContent":"        ScanOnPush: false","expected":"Resources.ecrepo.Properties.ImageScanningConfiguration.ScanOnPush should be set to true","found":"Resources.ecrepo.Properties.ImageScanningConfiguration.ScanOnPush is set to false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.MyRepository.Properties.ImageScanningConfiguration.ScanOnPush","fileName":"/harness/KaiMonkey/cft/misc/ecr-repository/deploy.json","lineNumber":9,"matchContent":"          \"ScanOnPush\": false","expected":"Resources.MyRepository.Properties.ImageScanningConfiguration.ScanOnPush should be set to true","found":"Resources.MyRepository.Properties.ImageScanningConfiguration.ScanOnPush is set to false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c36fa61b-6edd-471c-b4d1-8dc62ac5e861","name":"RDS PostgreSQL instance logs should be published to CloudWatch"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_db_instance[km_db]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":45,"matchContent":"resource \"aws_db_instance\" \"km_db\" {","expected":"'aws_db_instance[km_db].enabled_cloudwatch_logs_exports' should be defined and have one or more values.","found":"'aws_db_instance[km_db].enabled_cloudwatch_logs_exports' is undefined, null, or empty.","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"61e8ecdd-8bb5-45d0-bbd9-259bb0a534a7","name":"RDS instance performance insights should be enabled"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_db_instance[km_db]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":45,"matchContent":"resource \"aws_db_instance\" \"km_db\" {","expected":"'aws_db_instance[km_db].performance_insights_enabled' should be defined and set to true","found":"'aws_db_instance[km_db].performance_insights_enabled' is undefined","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c4d0f13d-eec0-4177-9270-31f13e643b02","name":"RDS instance should use the latest engine version"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_db_instance[km_db].engine_version","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":49,"matchContent":"  engine_version            = \"10.6\"","expected":"aws_db_instance[km_db].engine_version should not be set to %!d(string=16.2-r1)","found":"aws_db_instance[km_db].engine_version is set to %!d(string=10.6)","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"70663843-6809-486e-88a8-239cc65174ca","name":"REST API Gateway content encoding should be enabled"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyRestApi.Properties.MinimumCompressionSize","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-rest-api/deploy.yml","lineNumber":23,"matchContent":"      MinimumCompressionSize: -1","expected":"Resources.%s.Properties.MinimumCompressionSize should be greater than -1 and smaller than 10485760","found":"Resources.%s.Properties.MinimumCompressionSize is set to smaller than 0","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"12bea3d9-4cd5-403f-b2e1-ec6b7e400557","name":"REST API Gateway stage should be associated with a usage plan"},"severity":"LOW","failedResourceCount":4,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.Prod","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-method-settings/deploy.yml","lineNumber":2,"matchContent":"  Prod:","expected":"Resources.Prod should have UsagePlan defined","found":"Resources.Prod doesn't have UsagePlan defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.Prod","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-method-settings/deploy.yml","lineNumber":2,"matchContent":"  Prod:","expected":"Resources.Prod should have AWS::ApiGateway::UsagePlan associated, RestApiId and StageName should be the same as the Prod resource","found":"Resources.Prod should have AWS::ApiGateway::UsagePlan associated, RestApiId and StageName should be the same in the Prod resource","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.Prod","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-stage/deploy.json","lineNumber":4,"matchContent":"    \"Prod\": {","expected":"Resources.Prod should have UsagePlan defined","found":"Resources.Prod doesn't have UsagePlan defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.Prod","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-stage/deploy.json","lineNumber":4,"matchContent":"    \"Prod\": {","expected":"Resources.Prod should have AWS::ApiGateway::UsagePlan associated, RestApiId and StageName should be the same as the Prod resource","found":"Resources.Prod should have AWS::ApiGateway::UsagePlan associated, RestApiId and StageName should be the same in the Prod resource","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"8b8bc9ad-e583-4449-a807-c73fe9231cac","name":"REST API Gateway stages X-Ray tracing should be enabled"},"severity":"LOW","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.Prod.Properties","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-method-settings/deploy.yml","lineNumber":4,"matchContent":"    Properties:","expected":"Resources.Prod.Properties.TracingEnabled should be defined","found":"Resources.Prod.Properties.TracingEnabled is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.Prod.Properties","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-stage/deploy.json","lineNumber":9,"matchContent":"      \"Properties\": {","expected":"Resources.Prod.Properties.TracingEnabled should be defined","found":"Resources.Prod.Properties.TracingEnabled is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"a693420c-9430-4959-9106-f600be5881b4","name":"REST API Gateway stages' response caching should be enabled"},"severity":"LOW","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.Prod.Properties","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-method-settings/deploy.yml","lineNumber":4,"matchContent":"    Properties:","expected":"Resources.Prod.Properties.CacheClusterEnabled should be defined and not null","found":"Resources.Prod.Properties.CacheClusterEnabled is undefined or null","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.Prod.Properties","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-stage/deploy.json","lineNumber":9,"matchContent":"      \"Properties\": {","expected":"Resources.Prod.Properties.CacheClusterEnabled should be defined and not null","found":"Resources.Prod.Properties.CacheClusterEnabled is undefined or null","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"44638e37-552e-4b10-91e9-784919e9c878","name":"Redshift cluster connection logs should be enabled"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.NoLogging.Properties","fileName":"/harness/KaiMonkey/cft/misc/redshift_cluster/deploy.yml","lineNumber":53,"matchContent":"    Properties:","expected":"Resources.NoLogging.Properties.LoggingProperties should be set","found":"Resources.NoLogging.Properties.LoggingProperties is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3f56870a-3b0a-482d-99f8-7d788b9f656e","name":"Resource should be protected by Shield Advanced"},"severity":"LOW","failedResourceCount":5,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.elb","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":121,"matchContent":"              \"Ref\": \"elb\"","expected":"Resources.elb has shield advanced associated","found":"Resources.elb does not have shield advanced associated","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.cloudFrontDistribution","fileName":"/harness/KaiMonkey/cft/misc/cloudfront-distribution/deploy.json","lineNumber":4,"matchContent":"        \"cloudFrontDistribution\": {","expected":"Resources.cloudFrontDistribution has shield advanced associated","found":"Resources.cloudFrontDistribution does not have shield advanced associated","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.MyLoadBalancer","fileName":"/harness/KaiMonkey/cft/network/elasticloadbalancing-loadbalancer/deploy.yml","lineNumber":2,"matchContent":"  MyLoadBalancer:","expected":"Resources.MyLoadBalancer has shield advanced associated","found":"Resources.MyLoadBalancer does not have shield advanced associated","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_eip[km_eip]","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":55,"matchContent":"resource \"aws_eip\" \"km_eip\" {","expected":"aws_eip has shield advanced associated","found":"aws_eip does not have shield advanced associated","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_lb[km_lb]","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":156,"matchContent":"resource \"aws_lb\" \"km_lb\" {","expected":"aws_lb has shield advanced associated","found":"aws_lb does not have shield advanced associated","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"aaf2f336-7c79-4003-8ab7-221091eff36c","name":"S3 Bucket MFA Delete should be enabled"},"severity":"LOW","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_s3_bucket[mybucket]","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/test.tf","lineNumber":1,"matchContent":"resource \"aws_s3_bucket\" \"mybucket\" {","expected":"'aws_s3_bucket[mybucket]' MFA Delete should be enabled","found":"'aws_s3_bucket[mybucket]' MFA Delete is disabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_blob_storage]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":104,"matchContent":"resource \"aws_s3_bucket\" \"km_blob_storage\" {","expected":"'aws_s3_bucket[km_blob_storage]' MFA Delete should be enabled","found":"'aws_s3_bucket[km_blob_storage]' MFA Delete is disabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_public_blob]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":112,"matchContent":"resource \"aws_s3_bucket\" \"km_public_blob\" {","expected":"'aws_s3_bucket[km_public_blob]' MFA Delete should be enabled","found":"'aws_s3_bucket[km_public_blob]' MFA Delete is disabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"efe8a8c6-895c-4657-b1e9-7e45d3b23dd1","name":"S3 Bucket logging should be enabled"},"severity":"LOW","failedResourceCount":4,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.S3Bucket.Properties","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":5,"matchContent":"    Properties:","expected":"'Resources.S3Bucket.Properties' should have property 'LoggingConfiguration'","found":"'Resources.S3Bucket.Properties' doesn't have property 'LoggingConfiguration'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[mybucket]","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/test.tf","lineNumber":1,"matchContent":"resource \"aws_s3_bucket\" \"mybucket\" {","expected":"aws_s3_bucket[mybucket] logging should be enabled","found":"aws_s3_bucket[mybucket] logging is disabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_blob_storage]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":104,"matchContent":"resource \"aws_s3_bucket\" \"km_blob_storage\" {","expected":"aws_s3_bucket[km_blob_storage] logging should be enabled","found":"aws_s3_bucket[km_blob_storage] logging is disabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_public_blob]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":112,"matchContent":"resource \"aws_s3_bucket\" \"km_public_blob\" {","expected":"aws_s3_bucket[km_public_blob] logging should be enabled","found":"aws_s3_bucket[km_public_blob] logging is disabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"16710349-f69d-4c7c-bffa-2d1f561f0ef6","name":"S3 Bucket object lock should be enabled"},"severity":"LOW","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_s3_bucket[mybucket]","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/test.tf","lineNumber":1,"matchContent":"resource \"aws_s3_bucket\" \"mybucket\" {","expected":"'aws_s3_bucket[mybucket]' object lock should be enabled","found":"'aws_s3_bucket[mybucket]' object lock is disabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_blob_storage]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":104,"matchContent":"resource \"aws_s3_bucket\" \"km_blob_storage\" {","expected":"'aws_s3_bucket[km_blob_storage]' object lock should be enabled","found":"'aws_s3_bucket[km_blob_storage]' object lock is disabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_public_blob]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":112,"matchContent":"resource \"aws_s3_bucket\" \"km_public_blob\" {","expected":"'aws_s3_bucket[km_public_blob]' object lock should be enabled","found":"'aws_s3_bucket[km_public_blob]' object lock is disabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"9f63fe18-2e6f-475d-99d6-a2a7e988c523","name":"Unused Security Group should be deleted"},"severity":"LOW","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[km_ecs_sg]","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":132,"matchContent":"resource \"aws_security_group\" \"km_ecs_sg\" {","expected":"'aws_security_group[km_ecs_sg]' should be used","found":"'aws_security_group[km_ecs_sg]' is not used","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"5a7930b8-f3f2-413c-8311-081322275fdd","name":"VPC Flow Logs should be enabled in all applicable AWS regions"},"severity":"LOW","failedResourceCount":5,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.vipc","fileName":"/harness/KaiMonkey/cft/ec2/vpc/deploy.yml","lineNumber":3,"matchContent":"  vipc:","expected":"Resources.vipc has a FlowLogs resource associated","found":"Resources.vipc doesn't have a FlowLogs resource associated","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.VPC","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":175,"matchContent":"    \"VPC\": {","expected":"Resources.VPC has a FlowLogs resource associated","found":"Resources.VPC doesn't have a FlowLogs resource associated","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.daxVpc","fileName":"/harness/KaiMonkey/cft/misc/dax-cluster/deploy.yaml","lineNumber":27,"matchContent":"        !Ref daxVpc","expected":"Resources.daxVpc has a FlowLogs resource associated","found":"Resources.daxVpc doesn't have a FlowLogs resource associated","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_vpc[km_vpc]","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":4,"matchContent":"resource \"aws_vpc\" \"km_vpc\" {","expected":"aws_vpc[km_vpc] should be the same as Flow Logs VPC id","found":"aws_vpc[km_vpc] is not the same as Flow Logs VPC id","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_vpc[demo-vpc]","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":151,"matchContent":"resource \"aws_vpc\" \"demo-vpc\" {","expected":"aws_vpc[demo-vpc] should be the same as Flow Logs VPC id","found":"aws_vpc[demo-vpc] is not the same as Flow Logs VPC id","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"d5dc2fbc-41d3-4b94-bf58-4cd04b337611","name":"AKS cluster authorized IP ranges should be set"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name=[parameters('aksClusterName')]","fileName":"/harness/KaiMonkey/arm/kubernetes-cluster/azuredeploy.json","lineNumber":848,"matchContent":"      \"name\": \"[parameters('aksClusterName')]\",","expected":"'apiServerAccessProfile.authorizedIPRanges' should be defined as an array","found":"'apiServerAccessProfile.authorizedIPRanges' is undefined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e0da1348-a9a4-4529-9f8c-1b798b763f34","name":"Amazon MQ broker should be encrypted with a customer-managed key"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.PublicBroker.Properties.EncryptionOptions","fileName":"/harness/KaiMonkey/cft/misc/mq-borker/deploy.yml","lineNumber":4,"matchContent":"    Properties:","expected":"Resources.PublicBroker.Properties.EncryptionOptions should be defined","found":"Resources.PublicBroker.Properties.EncryptionOptions is not defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.NoLogsBroker.Properties.EncryptionOptions","fileName":"/harness/KaiMonkey/cft/misc/mq-borker/deploy.yml","lineNumber":22,"matchContent":"    Properties:","expected":"Resources.NoLogsBroker.Properties.EncryptionOptions should be defined","found":"Resources.NoLogsBroker.Properties.EncryptionOptions is not defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"9de52666-03d6-46f8-9eea-281ad2e03909","name":"Amazon MQ broker should not be publicly accessible"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.PublicBroker.Properties.PubliclyAccessible","fileName":"/harness/KaiMonkey/cft/misc/mq-borker/deploy.yml","lineNumber":10,"matchContent":"      PubliclyAccessible: true","expected":"Resources.PublicBroker.Properties.PubliclyAccessible should be set to false or undefined","found":"Resources.PublicBroker.Properties.PubliclyAccessible is true","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"b20a1cfd-7f14-4156-9c15-5b6d87ff8e13","name":"Amazon MQ broker should publish logs to Amazon CloudWatch Logs"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.PublicBroker.Properties","fileName":"/harness/KaiMonkey/cft/misc/mq-borker/deploy.yml","lineNumber":4,"matchContent":"    Properties:","expected":"Resources.PublicBroker.Properties.Logs should be set","found":"Resources.PublicBroker.Properties.Logs is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.NoLogsBroker.Properties.Logs.Audit","fileName":"/harness/KaiMonkey/cft/misc/mq-borker/deploy.yml","lineNumber":29,"matchContent":"        Audit: false","expected":"Resources.NoLogsBroker.Properties.Logs.Audit is true","found":"Resources.NoLogsBroker.Properties.Logs.Audit is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"0cb0257b-49ce-4c13-a841-710a9f6e2731","name":"App Service Microsoft Entra ID (AAD) should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name={{[parameters('siteName')]}}","fileName":"/harness/KaiMonkey/arm/mysql-server/azuredeploy.json","lineNumber":114,"matchContent":"            \"apiVersion\": \"2020-06-01\",","expected":"resource with type 'Microsoft.Web/sites' should have the 'identity' property defined","found":"resource with type 'Microsoft.Web/sites' doesn't have 'identity' property defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"4310aad5-abfe-4b3b-a8df-39ca309e1353","name":"App Service should use TLS version 1.2 or higher"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name=[parameters('siteName')]","fileName":"/harness/KaiMonkey/arm/mysql-server/azuredeploy.json","lineNumber":131,"matchContent":"            \"name\": \"[parameters('siteName')]\",","expected":"'siteConfig.minTlsVersion' should be 1.2","found":"'siteConfig.minTlsVersion' is undefined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"556ef889-9df2-43aa-b8bd-735a987d60d8","name":"App Service should use the latest HTTP version"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name={{[parameters('siteName')]}}.properties","fileName":"/harness/KaiMonkey/arm/mysql-server/azuredeploy.json","lineNumber":137,"matchContent":"            \"properties\": {","expected":"resource with type 'Microsoft.Web/sites' should have the 'siteConfig' property defined","found":"resource with type 'Microsoft.Web/sites' doesn't have 'siteConfig' property defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3e4e8ff0-1c36-42f9-9fc0-df19519b41f7","name":"Application Load Balancer should allow only HTTPS traffic for a forward configuration"},"severity":"MEDIUM","failedResourceCount":4,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.elb.Properties.Listeners.Protocol=HTTP","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":165,"matchContent":"            \"Protocol\": \"HTTP\"","expected":"'Resources.elb.Listeners.Protocol' should not equal to 'HTTP'","found":"'Resources.elb.Listeners.Protocol' equals to 'HTTP'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.HTTPlistener.Properties.Protocol=HTTP","fileName":"/harness/KaiMonkey/cft/network/elasticloadbalancerv2-listener/deploy.yml","lineNumber":16,"matchContent":"     Protocol: \"HTTP\"","expected":"'Resources.HTTPlistener.Protocol' should not equal to 'HTTP'","found":"'Resources.HTTPlistener.Protocol' equals to 'HTTP'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.MyLoadBalancer.Properties.Listeners.Protocol=HTTP","fileName":"/harness/KaiMonkey/cft/network/elasticloadbalancing-loadbalancer/deploy.yml","lineNumber":12,"matchContent":"        Protocol: HTTP","expected":"'Resources.MyLoadBalancer.Listeners.Protocol' should not equal to 'HTTP'","found":"'Resources.MyLoadBalancer.Listeners.Protocol' equals to 'HTTP'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_lb_listener[km_frontend_listener].default_action","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":176,"matchContent":"  default_action {","expected":"'default_action.redirect.protocol' should be equal to 'HTTPS'","found":"'default_action.redirect' is missing","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"f3377ed8-dd57-45fe-8151-469862f07f7f","name":"Application Load Balancer should be integrated with a WAF"},"severity":"MEDIUM","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.elb","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":121,"matchContent":"              \"Ref\": \"elb\"","expected":"'Resources.elb' should not have an 'internal' scheme and should have a 'WebACLAssociation' associated","found":"'Resources.elb' does not have an 'internal' scheme and a 'WebACLAssociation' associated","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.MyLoadBalancer","fileName":"/harness/KaiMonkey/cft/network/elasticloadbalancing-loadbalancer/deploy.yml","lineNumber":2,"matchContent":"  MyLoadBalancer:","expected":"'Resources.MyLoadBalancer' should not have an 'internal' scheme and should have a 'WebACLAssociation' associated","found":"'Resources.MyLoadBalancer' does not have an 'internal' scheme and a 'WebACLAssociation' associated","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_lb[km_lb]","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":156,"matchContent":"resource \"aws_lb\" \"km_lb\" {","expected":"'aws_lb[km_lb]' that is not 'internal' should have a 'aws_wafregional_web_acl_association' resource associated","found":"'aws_lb[km_lb]' that is not 'internal' does not have a 'aws_wafregional_web_acl_association' associated","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e5080d3b-05a0-4b47-b13a-bb37954819ea","name":"Application Load Balancer should drop invalid headers"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_lb[{{km_lb}}]","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":156,"matchContent":"resource \"aws_lb\" \"km_lb\" {","expected":"aws_lb[{{km_lb}}].drop_invalid_header_fields should be set to true","found":"aws_lb[{{km_lb}}].drop_invalid_header_fields is missing","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"9b82a298-743b-471e-b951-d220425be986","name":"Application Load Balancer should not support insecure negotiation policy"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_lb[km_lb]","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":156,"matchContent":"resource \"aws_lb\" \"km_lb\" {","expected":"The ALB should not support an insecure negotiation policy","found":"The ALB supports an insecure negotiation policy","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"bd2d333d-f657-4c34-b822-f9e03755cbb5","name":"Aurora Cluster IAM authentication should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.Prod.Properties","fileName":"/harness/KaiMonkey/cft/misc/neptune-cluster/deploy.json","lineNumber":6,"matchContent":"      \"Properties\" : {","expected":"Resources.Prod.Properties.IamAuthEnabled should be set to true","found":"Resources.Prod.Properties.IamAuthEnabled is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"fb20c589-83d8-4e92-8c0e-2f5f805bb329","name":"Classic Load Balancer access logging should be enabled"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.elb.Properties","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":155,"matchContent":"      \"Properties\": {","expected":"'Resources.elb.Properties.AccessLoggingPolicy' should exist","found":"'Resources.elb.Properties.AccessLoggingPolicy' is missing","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.MyLoadBalancer.Properties","fileName":"/harness/KaiMonkey/cft/network/elasticloadbalancing-loadbalancer/deploy.yml","lineNumber":4,"matchContent":"    Properties:","expected":"'Resources.MyLoadBalancer.Properties.AccessLoggingPolicy' should exist","found":"'Resources.MyLoadBalancer.Properties.AccessLoggingPolicy' is missing","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"f83aa8c4-3f13-4102-bc7c-e88456ad9a6b","name":"Classic Load Balancer listeners should use SSL/HTTPS"},"severity":"MEDIUM","failedResourceCount":4,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.elb.Properties.Listeners","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":159,"matchContent":"        \"Listeners\": [","expected":"'Resources.elb.Listeners.InstanceProtocol' should be set to 'SSL' or 'HTTPS'","found":"'Resources.elb.Listeners.InstanceProtocol' isn't set to 'SSL' or 'HTTPS'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.elb.Properties.Listeners","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":165,"matchContent":"            \"Protocol\": \"HTTP\"","expected":"'Resources.elb.Listeners.Protocol' should be set to 'SSL' or 'HTTPS'","found":"'Resources.elb.Listeners.Protocol' isn't set to 'SSL' or 'HTTPS'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.MyLoadBalancer.Properties.Listeners","fileName":"/harness/KaiMonkey/cft/network/elasticloadbalancing-loadbalancer/deploy.yml","lineNumber":10,"matchContent":"        InstanceProtocol: HTTP","expected":"'Resources.MyLoadBalancer.Listeners.InstanceProtocol' should be set to 'SSL' or 'HTTPS'","found":"'Resources.MyLoadBalancer.Listeners.InstanceProtocol' isn't set to 'SSL' or 'HTTPS'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.MyLoadBalancer.Properties.Listeners","fileName":"/harness/KaiMonkey/cft/network/elasticloadbalancing-loadbalancer/deploy.yml","lineNumber":12,"matchContent":"        Protocol: HTTP","expected":"'Resources.MyLoadBalancer.Listeners.Protocol' should be set to 'SSL' or 'HTTPS'","found":"'Resources.MyLoadBalancer.Listeners.Protocol' isn't set to 'SSL' or 'HTTPS'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"5d79c6f6-9791-4419-a8c1-54dfbf69ce04","name":"CloudTrail logs should be encrypted with SSE-KMS"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myTrail.Properties","fileName":"/harness/KaiMonkey/cft/misc/cloudtrail/deploy.json","lineNumber":6,"matchContent":"      \"Properties\": {","expected":"'Resources.myTrail.Properties.KMSKeyId' should be defined and not null","found":"'Resources.myTrail.Properties.KMSKeyId' is undefined or null","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"1d61c28b-0a6f-4917-a106-f992dc1a5734","name":"CloudWatch Log Group retention period should be at least a year"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_cloudwatch_log_group[km_log_group].retention_in_days","fileName":"/harness/KaiMonkey/terraform/aws/modules/compute/main.tf","lineNumber":117,"matchContent":"  retention_in_days = 1","expected":"'aws_cloudwatch_log_group[km_log_group].retention_in_days' should be at least 365 or set to 0 for indefinite retention","found":"'aws_cloudwatch_log_group[km_log_group].retention_in_days' is set to '1'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"afdd4af8-1bfd-40f9-ae83-ca5a631a6d40","name":"CloudWatch Log Group should be encrypted using KMS"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_cloudwatch_log_group[km_log_group]","fileName":"/harness/KaiMonkey/terraform/aws/modules/compute/main.tf","lineNumber":115,"matchContent":"resource \"aws_cloudwatch_log_group\" \"km_log_group\" {","expected":"Attribute 'kms_key_id' should be set","found":"Attribute 'kms_key_id' is undefined","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ca5ea0b1-799d-4bb5-b379-bc6e37ea58dc","name":"Cognito user pool MFA should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.pool.Properties","fileName":"/harness/KaiMonkey/cft/cognito/user-pool/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"Resources.pool.Properties.MfaConfiguration should be set","found":"Resources.pool.Properties.MfaConfiguration is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ec831337-7c82-4cc3-b3d7-2c557bcf7657","name":"Config rule for encrypted volumes should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ConfigRuleForVolumeTags","fileName":"/harness/KaiMonkey/cft/config/config-configrule/deploy.json","lineNumber":5,"matchContent":"    \"ConfigRuleForVolumeTags\": {","expected":"There should be a ConfigRule for encrypted volumes.","found":"There isn't a ConfigRule for encrypted volumes.","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e1077631-f5fd-4dff-8666-139c278b5f41","name":"Database instance IAM authentication should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyDB.Properties.EnableIAMDatabaseAuthentication","fileName":"/harness/KaiMonkey/cft/rds/db-instance/deploy.yml","lineNumber":66,"matchContent":"      EnableIAMDatabaseAuthentication: false","expected":"Resources.MyDB.Properties.EnableIAMDatabaseAuthentication should be true","found":"Resources.MyDB.Properties.EnableIAMDatabaseAuthentication is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"0bca8aef-edf4-4be8-926c-773bc4dabe4d","name":"Database instance automated backups should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_db_instance[km_db]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":45,"matchContent":"resource \"aws_db_instance\" \"km_db\" {","expected":"'backup_retention_period' should be defined, and bigger than '0'","found":"'backup_retention_period' is not defined","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"6feb117b-4661-4b7b-bda1-ef72ef47af1e","name":"Database instance automatic minor version upgrade should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyDB.Properties.AutoMinorVersionUpgrade","fileName":"/harness/KaiMonkey/cft/rds/db-instance/deploy.yml","lineNumber":65,"matchContent":"      AutoMinorVersionUpgrade: false","expected":"'Resources.MyDB.Properties.AutoMinorVersionUpgrade' should be true","found":"'Resources.MyDB.Properties.AutoMinorVersionUpgrade' is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"4f45d5d6-cf80-4576-8584-7ee4baac570f","name":"Database instance backup retention period should be at least a week"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.BackupRetention.Properties","fileName":"/harness/KaiMonkey/cft/rds/rds-cluster/deploy.yml","lineNumber":17,"matchContent":"    Properties:","expected":"The RDS DBCluster 'BackupRetention' resource should have backup retention period of at least 7 days","found":"The RDS DBCluster 'BackupRetention' resource doesn't define a backup retention period","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_db_instance[km_db]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":45,"matchContent":"resource \"aws_db_instance\" \"km_db\" {","expected":"'aws_db_instance[km_db].backup_retention_period' should be greater than 6 (days)","found":"'aws_db_instance[km_db].backup_retention_period' is less than 7 (or undefined).","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_db_instance\" \"example_db_instance\" {\n  backup_retention_period = 7\n}","fileRemediation":null}]},{"rule":{"id":"ad0367e3-f115-4f5b-b668-5d003e3b8085","name":"Database instance deletion protection should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyDB.Properties","fileName":"/harness/KaiMonkey/cft/rds/db-instance/deploy.yml","lineNumber":57,"matchContent":"    Properties:","expected":"Resources.MyDB.Properties.DeletionProtection should be defined","found":"Resources.MyDB.Properties.DeletionProtection is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"4908e346-765b-41ec-a031-4bf82cd85e7b","name":"Database instance multi-availability zone should be enabled"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyDB.Properties","fileName":"/harness/KaiMonkey/cft/rds/db-instance/deploy.yml","lineNumber":57,"matchContent":"    Properties:","expected":"The RDS DBInstance 'MyDB' should have Multi-Availability Zone enabled","found":"The RDS DBInstance 'MyDB' MultiAZ property is undefined and by default disabled","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_db_instance[km_db]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":45,"matchContent":"resource \"aws_db_instance\" \"km_db\" {","expected":"'aws_db_instance[km_db].multi_az' should be defined and 'true'.","found":"'aws_db_instance[km_db].multi_az' is undefined, 'null' or 'false'.","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e8ea5d42-1c30-4a9c-bd8f-ca9742951c6b","name":"Database instance should be encrypted with a customer-managed key"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myDBInstance3.Properties","fileName":"/harness/KaiMonkey/cft/misc/docdb-cluster/docdb_with_storage_encrypted.yml","lineNumber":5,"matchContent":"      Properties:","expected":"Resources.myDBInstance3.Properties.KmsKeyId should be defined with AWS-Managed CMK","found":"Resources.myDBInstance3.Properties.KmsKeyId is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.BackupRetention.Properties","fileName":"/harness/KaiMonkey/cft/rds/rds-cluster/deploy.yml","lineNumber":17,"matchContent":"    Properties:","expected":"Resources.BackupRetention.Properties.KmsKeyId should be defined with AWS-Managed CMK","found":"Resources.BackupRetention.Properties.KmsKeyId is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3d8ef523-d93e-46eb-9c82-4338bdb5e718","name":"Default Azure Storage Account network access should not be too permissive"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name=[variables('infraStorageAccountName')].properties.publicNetworkAccess","fileName":"/harness/KaiMonkey/arm/role-assignment/azuredeploy.json","lineNumber":113,"matchContent":"      \"properties\": {}","expected":"resource with type 'Microsoft.Storage/storageAccounts' publicNetworkAccess should be set to false, and/or networkAcls.defaultAction should be set to deny","found":"resource with type 'Microsoft.Storage/storageAccounts' publicNetworkAccess is not set (default is 'Enabled')","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"resources.name=[variables('stateStorageAccountName')].properties.publicNetworkAccess","fileName":"/harness/KaiMonkey/arm/role-assignment/azuredeploy.json","lineNumber":124,"matchContent":"      \"properties\": {}","expected":"resource with type 'Microsoft.Storage/storageAccounts' publicNetworkAccess should be set to false, and/or networkAcls.defaultAction should be set to deny","found":"resource with type 'Microsoft.Storage/storageAccounts' publicNetworkAccess is not set (default is 'Enabled')","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c47b8bbd-d6aa-4013-aa9b-6b5f0650a5dd","name":"Default network access rule for Storage Account should be set to deny"},"severity":"MEDIUM","failedResourceCount":4,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name=[variables('diagnosticStorageAccountName')]","fileName":"/harness/KaiMonkey/arm/key-vault-with-logging/azuredeploy.json","lineNumber":105,"matchContent":"      \"name\": \"[variables('diagnosticStorageAccountName')]\",","expected":"resource with type 'Microsoft.Storage/storageAccounts' should have the 'properties.networkAcls.defaultAction' defined","found":"resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'properties.networkAcls.defaultAction' defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"resources.name=[parameters('blobStorageAccountName')]","fileName":"/harness/KaiMonkey/arm/kubernetes-cluster/azuredeploy.json","lineNumber":649,"matchContent":"      \"name\": \"[parameters('blobStorageAccountName')]\",","expected":"resource with type 'Microsoft.Storage/storageAccounts' should have the 'properties.networkAcls.defaultAction' defined","found":"resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'properties.networkAcls.defaultAction' defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"resources.name=[variables('infraStorageAccountName')].properties","fileName":"/harness/KaiMonkey/arm/role-assignment/azuredeploy.json","lineNumber":113,"matchContent":"      \"properties\": {}","expected":"resource with type 'Microsoft.Storage/storageAccounts' should have the 'properties.networkAcls.defaultAction' defined","found":"resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'properties.networkAcls.defaultAction' defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"resources.name=[variables('stateStorageAccountName')].properties","fileName":"/harness/KaiMonkey/arm/role-assignment/azuredeploy.json","lineNumber":124,"matchContent":"      \"properties\": {}","expected":"resource with type 'Microsoft.Storage/storageAccounts' should have the 'properties.networkAcls.defaultAction' defined","found":"resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'properties.networkAcls.defaultAction' defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"68db7522-0447-43c9-906f-5ab689d4b3c6","name":"Direct Internet access should be disabled for SageMaker Notebook Instance"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.mysage.Properties.DirectInternetAccess","fileName":"/harness/KaiMonkey/cft/sagemaker/notebookinstance/deploy.yml","lineNumber":10,"matchContent":"      DirectInternetAccess: Enabled","expected":"Resources.mysage.Properties.DirectInternetAccess is enabled","found":"Resources.mysage.Properties.DirectInternetAccess is disabled","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"1b08ec67-2fd2-4c90-8598-c46b8a8fd6e8","name":"DocumentDB cluster should not a have master password in plaintext"},"severity":"MEDIUM","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myDBInstance1.Properties.MasterUserPassword","fileName":"/harness/KaiMonkey/cft/misc/docdb-cluster/deploy.json","lineNumber":12,"matchContent":"        \"MasterUserPassword\": \"your-master-user-password\",","expected":"Resources.myDBInstance1.Properties.MasterUserPassword must not be in plain text string","found":"Resources.myDBInstance1.Properties.MasterUserPassword must be defined as a parameter or have a secret manager referenced","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.myDBInstance2.Properties.MasterUserPassword","fileName":"/harness/KaiMonkey/cft/misc/docdb-cluster/docdb_with_kms.yml","lineNumber":12,"matchContent":"         MasterUserPassword : \"your-master-user-password\"","expected":"Resources.myDBInstance2.Properties.MasterUserPassword must not be in plain text string","found":"Resources.myDBInstance2.Properties.MasterUserPassword must be defined as a parameter or have a secret manager referenced","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.myDBInstance3.Properties.MasterUserPassword","fileName":"/harness/KaiMonkey/cft/misc/docdb-cluster/docdb_with_storage_encrypted.yml","lineNumber":11,"matchContent":"         MasterUserPassword : \"your-master-user-password\"","expected":"Resources.myDBInstance3.Properties.MasterUserPassword must not be in plain text string","found":"Resources.myDBInstance3.Properties.MasterUserPassword must be defined as a parameter or have a secret manager referenced","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ac65f9d2-3848-4e61-b34e-900b6a7f9f7b","name":"DocumentDB logs should be published to CloudWatch"},"severity":"MEDIUM","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myDBInstance1.Properties","fileName":"/harness/KaiMonkey/cft/misc/docdb-cluster/deploy.json","lineNumber":6,"matchContent":"      \"Properties\": {","expected":"AWS::DocDB::DBCluster.Properties.EnableCloudwatchLogsExports should be defined","found":"AWS::DocDB::DBCluster.Properties.EnableCloudwatchLogsExports is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.myDBInstance2.Properties","fileName":"/harness/KaiMonkey/cft/misc/docdb-cluster/docdb_with_kms.yml","lineNumber":5,"matchContent":"      Properties:","expected":"AWS::DocDB::DBCluster.Properties.EnableCloudwatchLogsExports should be defined","found":"AWS::DocDB::DBCluster.Properties.EnableCloudwatchLogsExports is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.myDBInstance3.Properties","fileName":"/harness/KaiMonkey/cft/misc/docdb-cluster/docdb_with_storage_encrypted.yml","lineNumber":5,"matchContent":"      Properties:","expected":"AWS::DocDB::DBCluster.Properties.EnableCloudwatchLogsExports should be defined","found":"AWS::DocDB::DBCluster.Properties.EnableCloudwatchLogsExports is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"66d837b7-aec3-4fd6-8d4d-8b9c50434e31","name":"DynamoDB Table point-in-time recovery should be enabled"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.DataDictionaryDynamoDBTable.Properties.PointInTimeRecoverySpecification.PointInTimeRecoveryEnabled","fileName":"/harness/KaiMonkey/cft/dynamodb/table/deploy.yaml","lineNumber":23,"matchContent":"        PointInTimeRecoveryEnabled: false","expected":"Resources[DataDictionaryDynamoDBTable].Properties.PointInTimeRecoverySpecification.PointInTimeRecoveryEnabled should be set to 'true'","found":"Resources[DataDictionaryDynamoDBTable].Properties.PointInTimeRecoverySpecification.PointInTimeRecoveryEnabled is set to 'false'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.myDynamoDBTable.Properties","fileName":"/harness/KaiMonkey/cft/misc/dynamodb-table/deploy.yaml","lineNumber":5,"matchContent":"    Properties: ","expected":"Resources[myDynamoDBTable].Properties.PointInTimeRecoverySpecification.PointInTimeRecoveryEnabled should be defined and set to 'true'","found":"Resources[myDynamoDBTable].Properties.PointInTimeRecoverySpecification is not defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ebd6bfa4-b7e2-4046-9017-c08611cc3921","name":"DynamoDB Table should not be encrypted with an AWS-owned key"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myDynamoDBTable.Properties.SSESpecification.SSEEnabled","fileName":"/harness/KaiMonkey/cft/misc/dynamodb-table/deploy.yaml","lineNumber":7,"matchContent":"        SSEEnabled: false","expected":"Resources[myDynamoDBTable].Properties.SSESpecification.SSEEnabled should be 'true'","found":"Resources[myDynamoDBTable].Properties.SSESpecification.SSEEnabled is 'false'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e8438f7c-80e4-412d-a47d-a81b4eb8cd1a","name":"EBS Volume should be encrypted"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.NewVolume.Properties.Encrypted","fileName":"/harness/KaiMonkey/cft/ec2/ebs-volume/deploy.json","lineNumber":8,"matchContent":"        \"Encrypted\": false,","expected":"Resources.NewVolume.Properties.Encrypted should be true","found":"Resources.NewVolume.Properties.Encrypted is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"6c1ff3b2-01e6-4b25-af16-e0e40710bee8","name":"EC2 Security Group should not allow access from all IP addresses"},"severity":"MEDIUM","failedResourceCount":7,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.OpenHttpPort.Properties.SecurityGroupIngress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":14,"matchContent":"          CidrIp: 0.0.0.0/0","expected":"Resources.OpenHttpPort.Properties.SecurityGroupIngress[0].CidrIp should not be open to the world (0.0.0.0/0)","found":"Resources.OpenHttpPort.Properties.SecurityGroupIngress[0].CidrIp is open to the world (0.0.0.0/0)","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.NoDescription.Properties.SecurityGroupIngress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":30,"matchContent":"          CidrIp: 0.0.0.0/0","expected":"Resources.NoDescription.Properties.SecurityGroupIngress[0].CidrIp should not be open to the world (0.0.0.0/0)","found":"Resources.NoDescription.Properties.SecurityGroupIngress[0].CidrIp is open to the world (0.0.0.0/0)","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":47,"matchContent":"          CidrIp: 0.0.0.0/0","expected":"Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress[0].CidrIp should not be open to the world (0.0.0.0/0)","found":"Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress[0].CidrIp is open to the world (0.0.0.0/0)","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.SshRule.Properties.SecurityGroupIngress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":65,"matchContent":"          CidrIp: 0.0.0.0/0","expected":"Resources.SshRule.Properties.SecurityGroupIngress[0].CidrIp should not be open to the world (0.0.0.0/0)","found":"Resources.SshRule.Properties.SecurityGroupIngress[0].CidrIp is open to the world (0.0.0.0/0)","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[km_alb_sg].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":107,"matchContent":"  ingress {","expected":"Security Group inbound rule should restrict the IP addresses range","found":"aws_security_group[km_alb_sg] ingress rule allows all IP addresses ('0.0.0.0/0', '::/0')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[km_rds_sg].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":19,"matchContent":"  ingress {","expected":"Security Group inbound rule should restrict the IP addresses range","found":"aws_security_group[km_rds_sg] ingress rule allows all IP addresses ('0.0.0.0/0', '::/0')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Security Group inbound rule should restrict the IP addresses range","found":"aws_security_group[web-app-security-group] ingress rule allows all IP addresses ('0.0.0.0/0', '::/0')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"2f9fefd7-de92-457f-a1b4-32192497c891","name":"EC2 Security Group should not allow outbound traffic to all IP addresses"},"severity":"MEDIUM","failedResourceCount":8,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.OpenHttpPort.Properties.SecurityGroupEgress[0].CidrIp","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"Resources.OpenHttpPort.Properties.SecurityGroupEgress[0].CidrIp should not be open to the world","found":"Resources.OpenHttpPort.Properties.SecurityGroupEgress[0].CidrIp is open to the world","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.NoDescription.Properties.SecurityGroupEgress[0].CidrIp","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":23,"matchContent":"    Properties:","expected":"Resources.NoDescription.Properties.SecurityGroupEgress[0].CidrIp should not be open to the world","found":"Resources.NoDescription.Properties.SecurityGroupEgress[0].CidrIp is open to the world","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.UnrestrictedUnknown.Properties.SecurityGroupEgress[0].CidrIp","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":38,"matchContent":"    Properties:","expected":"Resources.UnrestrictedUnknown.Properties.SecurityGroupEgress[0].CidrIp should not be open to the world","found":"Resources.UnrestrictedUnknown.Properties.SecurityGroupEgress[0].CidrIp is open to the world","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.SshRule.Properties.SecurityGroupEgress[0].CidrIp","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":56,"matchContent":"    Properties:","expected":"Resources.SshRule.Properties.SecurityGroupEgress[0].CidrIp should not be open to the world","found":"Resources.SshRule.Properties.SecurityGroupEgress[0].CidrIp is open to the world","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[km_alb_sg].egress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":121,"matchContent":"  egress {","expected":"Security Group outbound rule should restrict the IP addresses range","found":"aws_security_group[km_alb_sg] egress rule allows all IP addresses ('0.0.0.0/0', '::/0')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[km_ecs_sg].egress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":144,"matchContent":"  egress {","expected":"Security Group outbound rule should restrict the IP addresses range","found":"aws_security_group[km_ecs_sg] egress rule allows all IP addresses ('0.0.0.0/0', '::/0')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[km_rds_sg].egress","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":27,"matchContent":"  egress {","expected":"Security Group outbound rule should restrict the IP addresses range","found":"aws_security_group[km_rds_sg] egress rule allows all IP addresses ('0.0.0.0/0', '::/0')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].egress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":228,"matchContent":"  egress {","expected":"Security Group outbound rule should restrict the IP addresses range","found":"aws_security_group[web-app-security-group] egress rule allows all IP addresses ('0.0.0.0/0', '::/0')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"bb91ca9a-b150-4117-b8e5-d3024cbb7e9e","name":"EC2 Security Group should restrict inbound traffic to specific ports"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":42,"matchContent":"        SecurityGroupIngress:","expected":"Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress[0].FromPort should equal to Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress[0].ToPort","found":"Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress[0].FromPort is not equal to Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress[0].ToPort","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Security Group inbound rule should allow a specific port","found":"aws_security_group[web-app-security-group] ingress rule 'to_port' and 'from_port' have different values","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"4c6d6452-b4aa-449e-979c-3edf9943cee7","name":"EC2 instance should use an instance profile"},"severity":"MEDIUM","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myinstance.Properties","fileName":"/harness/KaiMonkey/cft/ec2/instance/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"'Resources.myinstance.Properties.IamInstanceProfile' should be set","found":"'Resources.myinstance.Properties.IamInstanceProfile' is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.myinstance.Properties","fileName":"/harness/KaiMonkey/cft/ssm/parameters/deploy.yml","lineNumber":16,"matchContent":"    Properties:","expected":"'Resources.myinstance.Properties.IamInstanceProfile' should be set","found":"'Resources.myinstance.Properties.IamInstanceProfile' is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_instance[km_vm]","fileName":"/harness/KaiMonkey/terraform/aws/modules/compute/main.tf","lineNumber":124,"matchContent":"resource \"aws_instance\" \"km_vm\"{","expected":"aws_instance[km_vm].iam_instance_profile should be configured","found":"aws_instance[km_vm].iam_instance_profile is not configured","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"57bbd788-5a67-4b83-98a8-ca03f43729bf","name":"ECS Cluster container insights should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_ecs_cluster[km_ecs_cluster]","fileName":"/harness/KaiMonkey/terraform/aws/modules/compute/main.tf","lineNumber":73,"matchContent":"resource \"aws_ecs_cluster\" \"km_ecs_cluster\" {","expected":"'aws_ecs_cluster[km_ecs_cluster].setting.name' should be set to 'containerInsights' and 'aws_ecs_cluster[km_ecs_cluster].setting.value' should be set to 'enabled'","found":"'aws_ecs_cluster[km_ecs_cluster].setting.name' is not set to 'containerInsights' and/or 'aws_ecs_cluster[km_ecs_cluster].setting.value' is not set to 'enabled'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"dd6f626b-3a32-4203-a902-bea84a10f87c","name":"ECS Task Definition EFS transit encryption should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.{\"Ref\": \"taskdefinition\"}","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":30,"matchContent":"  \"Resources\": {","expected":"Resources.{\"Ref\": \"taskdefinition\"} should be defined","found":"Resources.{\"Ref\": \"taskdefinition\"} is not defined.","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"12667831-2e21-4d12-9609-e3569675d86b","name":"ECS Task Definition network mode should be 'awsvpc'"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.taskdefinition.Properties","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":36,"matchContent":"      \"Properties\": {","expected":"'Resources.taskdefinition.Properties.NetworkMode' should be set and should be 'awsvpc'","found":"'Resources.taskdefinition.Properties.NetworkMode' is undefined and defaults to 'bridge'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.taskdefinition.Properties","fileName":"/harness/KaiMonkey/cft/ecs/ecs-task-definition/deploy.yml","lineNumber":4,"matchContent":"    Properties:","expected":"'Resources.taskdefinition.Properties.NetworkMode' should be set and should be 'awsvpc'","found":"'Resources.taskdefinition.Properties.NetworkMode' is undefined and defaults to 'bridge'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"52a5f531-9a53-461f-8385-f2e76ed95643","name":"ECS Task Definition task role should be configured"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ECSService.Properties.TaskDefinition","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":144,"matchContent":"        \"TaskDefinition\": {","expected":"'Resources.ECSService.Properties.TaskDefinition' refers to a TaskDefinition with Role","found":"'Resources.ECSService.Properties.TaskDefinition' does not refer to a TaskDefinition with Role","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"94c72181-1316-48a1-a354-da1e9358bf63","name":"EFS should be encrypted at rest"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.FileSystemResource.Properties.Encrypted","fileName":"/harness/KaiMonkey/cft/misc/efs-filesystem/deploy.json","lineNumber":13,"matchContent":"                \"Encrypted\": false,","expected":"EFS resource 'FileSystemResource' should have encryption enabled","found":"EFS resource 'FileSystemResource' has encryption set to false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"d8587fe9-9827-49d0-a820-d653525136a5","name":"ELBv2 listeners should use TLS/SSL"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_lb[km_lb]","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":156,"matchContent":"resource \"aws_lb\" \"km_lb\" {","expected":"All listeners 'protocol' should be set to 'HTTPS' or 'TLS'","found":"At least one listener 'protocol' is not set to 'HTTPS' or 'TLS'","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_lb_listener\" \"example_listener\" {\n  protocol = \"HTTPS\" // or \"TLS\"\n}","fileRemediation":null}]},{"rule":{"id":"acd769b8-62dd-49e4-9ede-c68a371cb989","name":"ELBv2 should have deletion protection enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_lb[km_lb]","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":156,"matchContent":"resource \"aws_lb\" \"km_lb\" {","expected":"'enable_deletion_protection' should be defined and set to true","found":"'enable_deletion_protection' is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"7a6257ed-3926-4032-82b4-c0894f6633fc","name":"EMR cluster should have a security configuration"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.somer.Properties","fileName":"/harness/KaiMonkey/cft/emr/cluster/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"Resources.somer.Properties.SecurityConfiguration should be defined","found":"Resources.somer.Properties.SecurityConfiguration is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"0b0c1f59-13d9-4559-bc9b-2a44f2545092","name":"ElastiCache Redis cluster in-transit encryption should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyBasicReplicationGroup.Properties.TransitEncryptionEnabled","fileName":"/harness/KaiMonkey/cft/elasticache/elasticache-replication-group/deploy.json","lineNumber":18,"matchContent":"        \"TransitEncryptionEnabled\": false,","expected":"Resources.MyBasicReplicationGroup.Properties.TransitEncryptionEnabled should be true","found":"Resources.MyBasicReplicationGroup.Properties.TransitEncryptionEnabled is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"15237c66-471e-4d04-b9cf-18de322c709d","name":"ElastiCache cluster should not use the default port"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyBasicReplicationGroup.Properties.Port","fileName":"/harness/KaiMonkey/cft/elasticache/elasticache-replication-group/deploy.json","lineNumber":16,"matchContent":"        \"Port\": 6379,","expected":"Resources.MyBasicReplicationGroup.Properties.Port should not be set to 6379","found":"Resources.MyBasicReplicationGroup.Properties.Port is set to 6379","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"223b77c3-b03c-4542-92c6-9ce5b6ba029e","name":"GuardDuty Detector should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.mydetector.Properties.Enable","fileName":"/harness/KaiMonkey/cft/misc/guardduty-detector/deploy.yml","lineNumber":6,"matchContent":"        Enable: False","expected":"Resources.mydetector.Properties.Enable should be set to true","found":"Resources.mydetector.Properties.Enable is set to false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"7019d038-2e98-4202-9829-5a3e3a246a54","name":"IAM Group should not have inline policies"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.RootGroup.Properties.Policies","fileName":"/harness/KaiMonkey/cft/iam/iam-group-policy/iam-group-policy.yml","lineNumber":6,"matchContent":"      Policies:","expected":"'Resources.Properties.Policies' should be undefined or empty","found":"'Resources.Properties.Policies' is not empty","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"a45aa14d-a544-44b7-89ff-d785125d0719","name":"IAM Role should not be vulnerable to the confused deputy problem"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_iam_role[km_ecs_task_execution_role].assume_role_policy","fileName":"/harness/KaiMonkey/terraform/aws/modules/compute/main.tf","lineNumber":13,"matchContent":"  assume_role_policy = \u003c\u003cEOF","expected":"'assume_role_policy' should not be vulnerable to the confused deputy problem","found":"'assume_role_policy' is vulnerable to the confused deputy problem","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_iam_role\" \"example_role\" {\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"cloudtrail.amazonaws.com\"\n        }\n        Action = \"sts:AssumeRole\"\n        Condition = {\n          StringEquals = {\n            \"aws:SourceAccount\" = \"123456789012\"\n          },\n          ArnLike = {\n            \"aws:SourceArn\" = \"arn:aws:cloudtrail:*:123456789012:trail/*\"\n          }\n        }\n      }\n    ]\n  })\n}","fileRemediation":null}]},{"rule":{"id":"e0d61704-cb27-4589-93ba-20fcd955bef7","name":"IAM User password should not be in plaintext"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.CFNUser.Properties.LoginProfile.Password","fileName":"/harness/KaiMonkey/cft/iam/iam-user/deploy.yml","lineNumber":6,"matchContent":"         Password: 'Password'","expected":"'Resources.CFNUser.Properties.LoginProfile.Password' should be a ref to a secretsmanager value","found":"'Resources.CFNUser.Properties.LoginProfile.Password' is a string literal","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3bcba2bb-bf43-4147-a655-a9aba0f77879","name":"IAM policy should not allow action that retrieves all IAM information"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_iam_policy[web-app-instance-policy].policy","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":60,"matchContent":"  policy      = \u003c\u003cPOLICY","expected":"'policy.Statement' should not allow 'iam:GetAccountAuthorizationDetails' for all resources.","found":"'policy.Statement' allows 'iam:GetAccountAuthorizationDetails' (or a wildcard allowing it) for all resources.","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_iam_policy[privileged-instance-policy].policy","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":111,"matchContent":"  policy      = \u003c\u003cPOLICY","expected":"'policy.Statement' should not allow 'iam:GetAccountAuthorizationDetails' for all resources.","found":"'policy.Statement' allows 'iam:GetAccountAuthorizationDetails' (or a wildcard allowing it) for all resources.","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3415d74d-ffd2-44d6-a40c-5550cb7f973e","name":"IAM policy should not have full administrative access"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyPolicy.Properties.PolicyDocument","fileName":"/harness/KaiMonkey/cft/iam/iam-policy/iam-policy.yml","lineNumber":7,"matchContent":"      PolicyDocument:","expected":"'Resources.Properties.PolicyDocument.Statement' shouldn't contain '*'","found":"'Resources.Properties.PolicyDocument.Statement' contains '*'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_iam_policy[privileged-instance-policy].policy","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":111,"matchContent":"  policy      = \u003c\u003cPOLICY","expected":"'policy.Statement.Action' shouldn't contain '*'","found":"'policy.Statement.Action' contains '*'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"191a8c76-82d8-4499-a9c7-e021b1f46184","name":"KMS key automatic rotation should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myKey.Properties.EnableKeyRotation","fileName":"/harness/KaiMonkey/cft/misc/kms-key/deploy.yml","lineNumber":7,"matchContent":"      EnableKeyRotation: false","expected":"Resources.myKey.Properties.EnableKeyRotation should not be 'true'","found":"Resources.myKey.Properties.EnableKeyRotation is true","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"f94191b8-55f4-44a3-95b1-627b24d4d977","name":"Key Vault purge protection should be enabled"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name={{[parameters('keyVaultName')]}}.properties","fileName":"/harness/KaiMonkey/arm/key-vault-with-logging/azuredeploy.json","lineNumber":84,"matchContent":"      \"properties\": {","expected":"resource with type 'Microsoft.KeyVault/vaults' should have 'enablePurgeProtection' property defined","found":"resource with type 'Microsoft.KeyVault/vaults' doesn't have 'enablePurgeProtection' property defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"resources.name={{[parameters('keyVaultName')]}}.properties","fileName":"/harness/KaiMonkey/arm/key-vault/azuredeploy.json","lineNumber":89,"matchContent":"      \"properties\": {","expected":"resource with type 'Microsoft.KeyVault/vaults' should have 'enablePurgeProtection' property defined","found":"resource with type 'Microsoft.KeyVault/vaults' doesn't have 'enablePurgeProtection' property defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"7a0f1197-6f8d-44a9-adbe-aed61dd5a740","name":"Kinesis should enforce server-side encryption"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyStream.Properties","fileName":"/harness/KaiMonkey/cft/kinesis/kinesis-stream/kinesis-stream.yml","lineNumber":4,"matchContent":"        Properties:","expected":"Resources.MyStream.Properties.StreamEncryption should be set","found":"Resources.MyStream.Properties.StreamEncryption is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"6821a06d-255f-4c98-8b1f-be48669f2c1b","name":"Lambda function environment variables should be encrypted at rest with KMS customer master key"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.serverless.Properties","fileName":"/harness/KaiMonkey/cft/serverless/function/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"'Resources.serverless.Properties.KmsKeyArn' should be defined and not null","found":"'Resources.serverless.Properties.KmsKeyArn' is undefined or null","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3b1b6dee-dc78-44b0-9855-f75cca66ecad","name":"Linux Virtual Machine password authentication should be disabled"},"severity":"MEDIUM","failedResourceCount":4,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name=[parameters('vmName')]","fileName":"/harness/KaiMonkey/arm/kubernetes-cluster/azuredeploy.json","lineNumber":679,"matchContent":"      \"name\": \"[parameters('vmName')]\",","expected":"'disablePasswordAuthentication' should be set to true","found":"'linuxConfiguration.disablePasswordAuthentication' is not defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"resources.name=[concat(variables('vmName'), copyIndex())]","fileName":"/harness/KaiMonkey/arm/network-security-group/azuredeploy.json","lineNumber":209,"matchContent":"      \"name\": \"[concat(variables('vmName'), copyIndex())]\",","expected":"'disablePasswordAuthentication' should be set to true","found":"'linuxConfiguration.disablePasswordAuthentication' is not defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"resources.name=[variables('vmName')]","fileName":"/harness/KaiMonkey/arm/role-assignment/azuredeploy.json","lineNumber":229,"matchContent":"      \"name\": \"[variables('vmName')]\",","expected":"'disablePasswordAuthentication' should be set to true","found":"'linuxConfiguration.disablePasswordAuthentication' is not defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"resources.name=[variables('vmName')]","fileName":"/harness/KaiMonkey/arm/virtual-machine/azuredeploy.json","lineNumber":155,"matchContent":"            \"name\": \"[variables('vmName')]\",","expected":"'disablePasswordAuthentication' should be set to true","found":"'linuxConfiguration.disablePasswordAuthentication' is not defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"6264581d-73bd-49dc-af4e-499ca8e75ce2","name":"MSK Cluster in transit encryption should be enabled"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.muskluster.Properties.EncryptionInfo.EncryptionInTransit.ClientBroker","fileName":"/harness/KaiMonkey/cft/msk/cluster/deploy.yml","lineNumber":22,"matchContent":"          ClientBroker: somebroker","expected":"Resources.muskluster.Properties.EncryptionInfo.EncryptionInTransit.ClientBroker is 'TLS'","found":"Resources.muskluster.Properties.EncryptionInfo.EncryptionInTransit.ClientBroker is not 'TLS'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.muskluster.Properties.EncryptionInfo.EncryptionInTransit.InCluster","fileName":"/harness/KaiMonkey/cft/msk/cluster/deploy.yml","lineNumber":23,"matchContent":"          InCluster: false","expected":"Resources.muskluster.Properties.EncryptionInfo.EncryptionInTransit.InCluster is 'true'","found":"Resources.muskluster.Properties.EncryptionInfo.EncryptionInTransit.InCluster is 'false'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"637399a4-fe03-4c90-986e-176d786b17a3","name":"MySQL Database Server 'Enforce SSL Connection' should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name={{[variables('serverName')]}}.properties.sslEnforcement","fileName":"/harness/KaiMonkey/arm/mysql-server/azuredeploy.json","lineNumber":180,"matchContent":"                \"sslEnforcement\": \"Disabled\"","expected":"resource with type 'Microsoft.DBforMySQL/servers' should have the 'sslEnforcement' property value set to 'Enabled'","found":"resource with type 'Microsoft.DBforMySQL/servers' doesn't have 'sslEnforcement' set to 'Enabled'","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"34a2cfa6-665a-4efe-a888-07c0b1552325","name":"Network Security Group should restrict SSH access (TCP - port 22)"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name={{[variables('vmSubnetNsgName')]}}.properties.securityRules","fileName":"/harness/KaiMonkey/arm/kubernetes-cluster/azuredeploy.json","lineNumber":785,"matchContent":"          \"properties\": {","expected":"resource with type 'Microsoft.Network/networkSecurityGroups' restricts access to SSH","found":"resource with type 'Microsoft.Network/networkSecurityGroups' does not restrict access to SSH","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"resources.name={{[variables('networkSecurityGroupName')]}}.properties.securityRules","fileName":"/harness/KaiMonkey/arm/role-assignment/azuredeploy.json","lineNumber":168,"matchContent":"            \"properties\": {","expected":"resource with type 'Microsoft.Network/networkSecurityGroups' restricts access to SSH","found":"resource with type 'Microsoft.Network/networkSecurityGroups' does not restrict access to SSH","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"b949797d-616a-47a2-9ca3-0e496df16a05","name":"OS disk should be encrypted"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name=[concat(parameters('virtualMachineName'),'-dataDisk-UltraSSD-',copyIndex())].properties.encryptionSettingsCollection.enabled","fileName":"/harness/KaiMonkey/arm/managed-disk/azuredeploy.json","lineNumber":212,"matchContent":"                \"enabled\": false,","expected":"'encryptionSettingsCollection.enabled' should be set to true","found":"'encryptionSettingsCollection.enabled' property value is set to false","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"60d44353-2e36-46ce-951a-70b45815defc","name":"OpenSearch (ElasticSearch) domain fine-grained access control should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ElasticsearchDomain.Properties.AdvancedSecurityOptions","fileName":"/harness/KaiMonkey/cft/misc/elasticsearch-domain/deploy.yml","lineNumber":4,"matchContent":"    Properties:","expected":"Resources.ElasticsearchDomain.Properties.AdvancedSecurityOptions should be enabled","found":"Resources.ElasticsearchDomain.Properties.AdvancedSecurityOptions is disabled","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"7466eef6-1630-4eb8-ab29-8faf2c113dd4","name":"OpenSearch (ElasticSearch) domain should be configured with HTTPS"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ElasticsearchDomain.Properties","fileName":"/harness/KaiMonkey/cft/misc/elasticsearch-domain/deploy.yml","lineNumber":4,"matchContent":"    Properties:","expected":"Resources.ElasticsearchDomain.Properties.DomainEndpointOptions.EnforceHTTPS should be defined and set to 'true'","found":"Resources.ElasticsearchDomain.Properties.DomainEndpointOptions.EnforceHTTPS is not set","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"9584eb89-e511-485c-a522-615b1964d113","name":"OpenSearch (ElasticSearch) domain should ensure IAM authentication"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ElasticsearchDomain.Properties.AccessPolicies.Statement","fileName":"/harness/KaiMonkey/cft/misc/elasticsearch-domain/deploy.yml","lineNumber":25,"matchContent":"          - Effect: Deny","expected":"Elasticsearch Domain should ensure IAM Authentication","found":"Elasticsearch Domain does not ensure IAM Authentication","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"28cb039c-c5e6-4aa5-a7f0-20c62722e1ef","name":"OpenSearch (Elasticsearch) domain should be encrypted with a customer-managed key"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ElasticsearchDomain.Properties.EncryptionAtRestOptions","fileName":"/harness/KaiMonkey/cft/misc/elasticsearch-domain/deploy.yml","lineNumber":13,"matchContent":"      EncryptionAtRestOptions:","expected":"Resources.ElasticsearchDomain.Properties.EncryptionAtRestOptions.KmsKeyId should be set","found":"Resources.ElasticsearchDomain.Properties.EncryptionAtRestOptions.KmsKeyId is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"93b1237f-fa2d-47db-b351-9f9abef05810","name":"OpenSearch (Elasticsearch) domain should encrypt data at rest"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ElasticsearchDomain.Properties.EncryptionAtRestOptions.Enabled","fileName":"/harness/KaiMonkey/cft/misc/elasticsearch-domain/deploy.yml","lineNumber":14,"matchContent":"        Enabled: false","expected":"Resources.ElasticsearchDomain.Properties.EncryptionAtRestOptions should be enabled","found":"Resources.ElasticsearchDomain.Properties.EncryptionAtRestOptions is disabled","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"6e4b1b76-e1e2-42ca-bf77-cd5236f14c04","name":"PostgreSQL Database Server 'Enforce SSL Connection' should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name={{[parameters('serverName')]}}.properties","fileName":"/harness/KaiMonkey/arm/postgresql-servers/azuredeploy.json","lineNumber":188,"matchContent":"      \"properties\": {","expected":"resource with type 'Microsoft.DBforPostgreSQL/servers' should have 'sslEnforcement' property defined","found":"resource with type 'Microsoft.DBforPostgreSQL/servers' doesn't have 'sslEnforcement' property defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"fe07adfe-409e-4b89-bf30-8ec5c9cb0782","name":"PostgreSQL Database Server should have 'connection_throttling' enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name=[parameters('serverName')]","fileName":"/harness/KaiMonkey/arm/postgresql-servers/azuredeploy.json","lineNumber":179,"matchContent":"      \"name\": \"[parameters('serverName')]\",","expected":"resource '[parameters('serverName')]' should have an 'auditingsettings' resource enabled","found":"resource '[parameters('serverName')]' doesn't have an 'auditingsettings' resource enabled","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"0c9afaac-c24e-46da-9cf9-4d56d02f8081","name":"RDS Cluster encryption at rest should be enabled"},"severity":"MEDIUM","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myDBInstance2.Properties","fileName":"/harness/KaiMonkey/cft/misc/docdb-cluster/docdb_with_kms.yml","lineNumber":5,"matchContent":"      Properties:","expected":"Resources.myDBInstance2.Properties.StorageEncrypted should be defined","found":"Resources.myDBInstance2.Properties.StorageEncrypted is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.Prod.Properties.StorageEncrypted","fileName":"/harness/KaiMonkey/cft/misc/neptune-cluster/deploy.json","lineNumber":11,"matchContent":"          \"StorageEncrypted\" : false","expected":"Resources.Prod.Properties.StorageEncrypted should be true","found":"Resources.Prod.Properties.StorageEncrypted is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.NoEncryption.Properties","fileName":"/harness/KaiMonkey/cft/rds/rds-cluster/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"Resources.NoEncryption.Properties.StorageEncrypted should be defined","found":"Resources.NoEncryption.Properties.StorageEncrypted is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"cdb5730f-0e90-4270-8ced-ebf5b131e0bd","name":"RDS DB instance security and access logs should be published to CloudWatch"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_db_instance[km_db].enabled_cloudwatch_logs_exports","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":45,"matchContent":"resource \"aws_db_instance\" \"km_db\" {","expected":"'aws_db_instance[km_db].enabled_cloudwatch_logs_exports' should be defined and not empty","found":"'aws_db_instance[km_db].enabled_cloudwatch_logs_exports' is undefined or empty","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_db_instance\" \"example_db\" {\n  enabled_cloudwatch_logs_exports = [\"audit\", \"error\", \"general\", \"slowquery\"]\n}","fileRemediation":null}]},{"rule":{"id":"a269a1a1-451e-4080-a400-ea4379f48899","name":"RDS Instance automated backups should be enabled and have an adequate retention period"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_db_instance[km_db]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":45,"matchContent":"resource \"aws_db_instance\" \"km_db\" {","expected":"'backup_retention_period' should be defined, and set to at least 7","found":"'backup_retention_period' is undefined","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3653ca9f-8799-4e7b-822e-d0958804aa10","name":"REST API Gateway should have an authorizer configured for all methods"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyRestApi","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-rest-api/deploy.yml","lineNumber":16,"matchContent":"  MyRestApi:","expected":"API Gateway REST API should be associated with an API Gateway Authorizer","found":"API Gateway REST API is not associated with an API Gateway Authorizer","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"bfad47be-1eeb-4e0a-b29f-83761d699986","name":"REST API Gateway stages should be configured with WAFv2 WebACL"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.Prod.Properties.StageName","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-method-settings/deploy.yml","lineNumber":5,"matchContent":"      StageName: Prod","expected":"API Gateway Stage should be associated with a Web Application Firewall","found":"API Gateway Stage is not associated with a Web Application Firewall","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.Prod.Properties.StageName","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-stage/deploy.json","lineNumber":10,"matchContent":"        \"StageName\": \"Prod\",","expected":"API Gateway Stage should be associated with a Web Application Firewall","found":"API Gateway Stage is not associated with a Web Application Firewall","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"d4026066-3b5d-454f-a9ea-c04e0548c413","name":"Redshift cluster should be encrypted with a customer-managed key"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.NoKmsId.Properties","fileName":"/harness/KaiMonkey/cft/misc/redshift_cluster/deploy.yml","lineNumber":21,"matchContent":"    Properties:","expected":"Resources.NoKmsId.Properties.KmsKeyId should be set","found":"Resources.NoKmsId.Properties.KmsKeyId is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"4a886dfa-0498-42b8-bddd-d4cce445bd3f","name":"Redshift cluster should not use the default port"},"severity":"MEDIUM","failedResourceCount":4,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.PubliclyAccessViolation.Properties","fileName":"/harness/KaiMonkey/cft/misc/redshift_cluster/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"'Resources.PubliclyAccessViolation.Properties.Port' should be defined","found":"'Resources.PubliclyAccessViolation.Properties.Port' is not defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.NoKmsId.Properties","fileName":"/harness/KaiMonkey/cft/misc/redshift_cluster/deploy.yml","lineNumber":21,"matchContent":"    Properties:","expected":"'Resources.NoKmsId.Properties.Port' should be defined","found":"'Resources.NoKmsId.Properties.Port' is not defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.NoEncryption.Properties","fileName":"/harness/KaiMonkey/cft/misc/redshift_cluster/deploy.yml","lineNumber":37,"matchContent":"    Properties:","expected":"'Resources.NoEncryption.Properties.Port' should be defined","found":"'Resources.NoEncryption.Properties.Port' is not defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.NoLogging.Properties","fileName":"/harness/KaiMonkey/cft/misc/redshift_cluster/deploy.yml","lineNumber":53,"matchContent":"    Properties:","expected":"'Resources.NoLogging.Properties.Port' should be defined","found":"'Resources.NoLogging.Properties.Port' is not defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"308e49f9-78fe-40b7-a924-fbe7607f2e30","name":"Route Table should not use the default routing setting"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.test-route-sp.Properties.DestinationCidrBlock","fileName":"/harness/KaiMonkey/cft/ec2/route/deploy.yaml","lineNumber":6,"matchContent":"      DestinationCidrBlock: \"0.0.0.0/0\"","expected":"Resources.test-route-sp.Properties.DestinationCidrBlock should be different from the default value","found":"Resources.test-route-sp.Properties.DestinationCidrBlock is 0.0.0.0/0","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"77aaf049-61c5-4138-92aa-7482fcb0b0e5","name":"S3 Bucket policy should deny HTTP requests"},"severity":"MEDIUM","failedResourceCount":4,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.S3Bucket","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":2,"matchContent":"  S3Bucket:","expected":"Resources.S3Bucket bucket has a policy that enforces SSL","found":"Resources.S3Bucket bucket doesn't have a policy or has a policy that doesn't enforce SSL","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[mybucket]","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/test.tf","lineNumber":1,"matchContent":"resource \"aws_s3_bucket\" \"mybucket\" {","expected":"'aws_s3_bucket[mybucket]' should deny unseucre HTTP requesets","found":"'aws_s3_bucket[mybucket]' does not explicitly deny HTTP requesets for all actions for all principals","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_blob_storage]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":104,"matchContent":"resource \"aws_s3_bucket\" \"km_blob_storage\" {","expected":"'aws_s3_bucket[km_blob_storage]' should deny unseucre HTTP requesets","found":"'aws_s3_bucket[km_blob_storage]' does not explicitly deny HTTP requesets for all actions for all principals","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_public_blob]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":112,"matchContent":"resource \"aws_s3_bucket\" \"km_public_blob\" {","expected":"'aws_s3_bucket[km_public_blob]' should deny unseucre HTTP requesets","found":"'aws_s3_bucket[km_public_blob]' does not explicitly deny HTTP requesets for all actions for all principals","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"6aba00b4-fb3c-46f7-88d3-9bff0084d9c2","name":"S3 Bucket policy should not allow S3 actions for all principals"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.S3Bucket","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":2,"matchContent":"  S3Bucket:","expected":"associated Bucket Policy should not allow access to any principal","found":"associated Bucket Policy allows access to any principal","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"a9914596-4f23-4ef9-9db7-b77dd0740007","name":"S3 Bucket should be encrypted with KMS (SSE-KMS)"},"severity":"MEDIUM","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_s3_bucket[mybucket]","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/test.tf","lineNumber":1,"matchContent":"resource \"aws_s3_bucket\" \"mybucket\" {","expected":"'aws_s3_bucket[mybucket]' should be encrypted using a customer-provided key","found":"'aws_s3_bucket[mybucket]' is not encrypted using a customer-provided key","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_blob_storage]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":104,"matchContent":"resource \"aws_s3_bucket\" \"km_blob_storage\" {","expected":"'aws_s3_bucket[km_blob_storage]' should be encrypted using a customer-provided key","found":"'aws_s3_bucket[km_blob_storage]' is not encrypted using a customer-provided key","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_public_blob]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":112,"matchContent":"resource \"aws_s3_bucket\" \"km_public_blob\" {","expected":"'aws_s3_bucket[km_public_blob]' should be encrypted using a customer-provided key","found":"'aws_s3_bucket[km_public_blob]' is not encrypted using a customer-provided key","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"46ed71b9-7904-4f41-ab20-c2fb1f5b3404","name":"S3 Bucket should have at least one replication rule enabled"},"severity":"MEDIUM","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_s3_bucket[mybucket]","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/test.tf","lineNumber":1,"matchContent":"resource \"aws_s3_bucket\" \"mybucket\" {","expected":"aws_s3_bucket[mybucket] should have at least one replication rule enabled","found":"aws_s3_bucket[mybucket] does not have an enabled replication rule","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_blob_storage]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":104,"matchContent":"resource \"aws_s3_bucket\" \"km_blob_storage\" {","expected":"aws_s3_bucket[km_blob_storage] should have at least one replication rule enabled","found":"aws_s3_bucket[km_blob_storage] does not have an enabled replication rule","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_public_blob]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":112,"matchContent":"resource \"aws_s3_bucket\" \"km_public_blob\" {","expected":"aws_s3_bucket[km_public_blob] should have at least one replication rule enabled","found":"aws_s3_bucket[km_public_blob] does not have an enabled replication rule","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ab98cfa3-d4ee-4ab1-9335-8c7ec4ae1695","name":"S3 Bucket should not be accessible to any authenticated user"},"severity":"MEDIUM","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_s3_bucket[mybucket]","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/test.tf","lineNumber":1,"matchContent":"resource \"aws_s3_bucket\" \"mybucket\" {","expected":"'aws_s3_bucket[mybucket]' ACL should not grant global authenticated users acccess","found":"'aws_s3_bucket[mybucket]' ACL grants global authenticated users acccess ('http://acs.amazonaws.com/groups/global/AuthenticatedUsers')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_blob_storage]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":104,"matchContent":"resource \"aws_s3_bucket\" \"km_blob_storage\" {","expected":"'aws_s3_bucket[km_blob_storage]' ACL should not grant global authenticated users acccess","found":"'aws_s3_bucket[km_blob_storage]' ACL grants global authenticated users acccess ('http://acs.amazonaws.com/groups/global/AuthenticatedUsers')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_public_blob]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":112,"matchContent":"resource \"aws_s3_bucket\" \"km_public_blob\" {","expected":"'aws_s3_bucket[km_public_blob]' ACL should not grant global authenticated users acccess","found":"'aws_s3_bucket[km_public_blob]' ACL grants global authenticated users acccess ('http://acs.amazonaws.com/groups/global/AuthenticatedUsers')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e4bbfa56-e8e3-482b-9b9e-70bf9f23d800","name":"S3 Bucket versioning should be enabled"},"severity":"MEDIUM","failedResourceCount":4,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.S3Bucket.Properties","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":5,"matchContent":"    Properties:","expected":"Resources.S3Bucket.Properties.VersioningConfiguration should be defined","found":"Resources.S3Bucket.Properties.VersioningConfiguration is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[mybucket]","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/test.tf","lineNumber":1,"matchContent":"resource \"aws_s3_bucket\" \"mybucket\" {","expected":"S3 Bucket Versioning is disabled","found":"S3 Bucket Versioning should be enabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_blob_storage]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":104,"matchContent":"resource \"aws_s3_bucket\" \"km_blob_storage\" {","expected":"S3 Bucket Versioning is disabled","found":"S3 Bucket Versioning should be enabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket[km_public_blob]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":112,"matchContent":"resource \"aws_s3_bucket\" \"km_public_blob\" {","expected":"S3 Bucket Versioning is disabled","found":"S3 Bucket Versioning should be enabled","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"8c92577e-f5b0-439f-80b0-108453d8da42","name":"SNS Topic Server-Side Encryption (SSE) should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MySNSTopic.Properties","fileName":"/harness/KaiMonkey/cft/sns/topic/deploy.yml","lineNumber":6,"matchContent":"    Properties:","expected":"Resources.MySNSTopic.Properties.KmsMasterKeyId is defined","found":"Resources.MySNSTopic.Properties.KmsMasterKeyId is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"53047393-3cfb-43da-a4ac-9c3c4388bd3a","name":"SNS Topic policy should not allow all principals"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.samplesnspolicy.Properties.PolicyDocument","fileName":"/harness/KaiMonkey/cft/sns/policy/deploy.yml","lineNumber":7,"matchContent":"      PolicyDocument:","expected":"Resources.samplesnspolicy.Properties.PolicyDocument.Statement should not allow actions from all principals","found":"Resources.samplesnspolicy.Properties.PolicyDocument.Statement allows actions from all principals","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"d65febcb-0742-47a8-882d-5eb6078da91a","name":"SNS Topic should be encrypted with a customer-managed key"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MySNSTopic.Properties","fileName":"/harness/KaiMonkey/cft/sns/topic/deploy.yml","lineNumber":6,"matchContent":"    Properties:","expected":"Resources.MySNSTopic.Properties.KmsMasterKeyId should be defined","found":"Resources.MySNSTopic.Properties.KmsMasterKeyId is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"7f31746a-a915-40ba-b716-2336a76cd1b1","name":"SQL Server 'Auditing' should be set to 'On'"},"severity":"MEDIUM","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.resources.name=[variables('databaseName')]","fileName":"/harness/KaiMonkey/arm/mysql-server/azuredeploy.json","lineNumber":198,"matchContent":"                    \"name\": \"[variables('databaseName')]\",","expected":"resource '[variables('databaseName')]' should have an enabled 'auditingsettings' resource","found":"resource '[variables('databaseName')]' is missing an enabled 'auditingsettings' resource","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"resources.name=[concat(parameters('serverName'), '/', parameters('databasesNames')[copyIndex()])]","fileName":"/harness/KaiMonkey/arm/sql-firewall-rule/azuredeploy.json","lineNumber":154,"matchContent":"      \"name\": \"[concat(parameters('serverName'), '/', parameters('databasesNames')[copyIndex()])]\",","expected":"resource '[concat(parameters('serverName'), '/', parameters('databasesNames')[copyIndex()])]' should have an enabled 'auditingsettings' resource","found":"resource '[concat(parameters('serverName'), '/', parameters('databasesNames')[copyIndex()])]' is missing an enabled 'auditingsettings' resource","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e02dfbdb-0609-4746-a1fe-8ab08a1215ef","name":"SQL Server with storage account auditing should have at least 90 retention days"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.resources.name={{DefaultAuditingSettings}}.properties.retentionDays","fileName":"/harness/KaiMonkey/arm/mssql-server/azuredeploy.json","lineNumber":122,"matchContent":"\t\t\t\"retentionDays\": 10","expected":"'auditingSettings.properties.retentionDays' property value should be defined and above 90 days","found":"'auditingSettings.properties.retentionDays' property value is 10","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"9b49d172-cb91-4a6f-87ad-64c7700dd718","name":"SQS Queue should be encrypted with a customer-managed key"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.samplequeue.Properties","fileName":"/harness/KaiMonkey/cft/sqs/queue/deploy.yml","lineNumber":6,"matchContent":"    Properties:","expected":"Resources.samplequeue.Properties.KmsMasterKeyId should be set or SqsManagedSseEnabled set to true","found":"Resources.samplequeue.Properties.KmsMasterKeyId is undefined and SqsManagedSseEnabled not enabled","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c4cf18f5-438d-4140-8f9f-740bcaee85e0","name":"SageMaker Notebook instance should be placed in a VPC and a subnet"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.mysage.Properties.SubnetId","fileName":"/harness/KaiMonkey/cft/sagemaker/notebookinstance/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"Resources.mysage.Properties.SubnetId should be defined","found":"Resources.mysage.Properties.SubnetId is not defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c32530a5-68b7-4157-b7b3-126cba5ee911","name":"Secret should be encrypted using a customer-managed key"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MySecret.Properties.KmsKeyId","fileName":"/harness/KaiMonkey/cft/secretsmanager/secretsmanager-secret-policy/deploy.yml","lineNumber":4,"matchContent":"      Properties:","expected":"Resources.MySecret.Properties.KmsKeyId should be true","found":"Resources.MySecret.Properties.KmsKeyId is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"acfdaf09-218c-40e1-b615-da2b52c57a0b","name":"Storage Account 'Trusted Microsoft Services' access should be enabled"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name=[parameters('storageAccountName')].properties.networkAcls","fileName":"/harness/KaiMonkey/arm/storage-account/azuredeploy.json","lineNumber":60,"matchContent":"                \"networkAcls\": {","expected":"resource with type 'Microsoft.Storage/storageAccounts' should have 'Trusted Microsoft Services' property value enabled","found":"resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'Trusted Microsoft Services' enabled","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3202c6c5-c3e6-4928-b7ef-4c51e24ccc75","name":"VPC Subnets should not allow automatic public IP assignment"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_subnet[km_public_subnet].map_public_ip_on_launch","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":47,"matchContent":"  map_public_ip_on_launch = true","expected":"aws_subnet[km_public_subnet].map_public_ip_on_launch should be set to false or undefined","found":"aws_subnet[km_public_subnet].map_public_ip_on_launch is set to true","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"106dd3c6-368a-4760-8df2-39cf2bdb6ffa","name":"VPC should be protected by a network firewall"},"severity":"MEDIUM","failedResourceCount":5,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.vipc","fileName":"/harness/KaiMonkey/cft/ec2/vpc/deploy.yml","lineNumber":3,"matchContent":"  vipc:","expected":"'Resources.vipc' should be associated with a AWS Network Firewall","found":"'Resources.vipc' is not associated with a AWS Network Firewall","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.VPC","fileName":"/harness/KaiMonkey/cft/ecs/ecs-service/deploy.json","lineNumber":175,"matchContent":"    \"VPC\": {","expected":"'Resources.VPC' should be associated with a AWS Network Firewall","found":"'Resources.VPC' is not associated with a AWS Network Firewall","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.daxVpc","fileName":"/harness/KaiMonkey/cft/misc/dax-cluster/deploy.yaml","lineNumber":43,"matchContent":"  daxVpc:","expected":"'Resources.daxVpc' should be associated with a AWS Network Firewall","found":"'Resources.daxVpc' is not associated with a AWS Network Firewall","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_vpc[km_vpc]","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":4,"matchContent":"resource \"aws_vpc\" \"km_vpc\" {","expected":"aws_vpc[km_vpc] has an 'aws_networkfirewall_firewall' associated","found":"aws_vpc[km_vpc] does not have an 'aws_networkfirewall_firewall' associated","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_vpc[demo-vpc]","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":151,"matchContent":"resource \"aws_vpc\" \"demo-vpc\" {","expected":"aws_vpc[demo-vpc] has an 'aws_networkfirewall_firewall' associated","found":"aws_vpc[demo-vpc] does not have an 'aws_networkfirewall_firewall' associated","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ad0493bc-9cb0-40cd-8bad-33b2aba9f6a0","name":"VPC should have subnets attached"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.vipc","fileName":"/harness/KaiMonkey/cft/ec2/vpc/deploy.yml","lineNumber":3,"matchContent":"  vipc:","expected":"'Resources.vipc' should be attached to resources","found":"'Resources.vipc' is not attached to resources","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"98903cbe-6dfd-4109-99d1-e6747fd37cb4","name":"Web App incoming client certificates should be required"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name={{[parameters('siteName')]}}.properties","fileName":"/harness/KaiMonkey/arm/mysql-server/azuredeploy.json","lineNumber":137,"matchContent":"            \"properties\": {","expected":"resource with type 'Microsoft.Web/sites' should have the 'clientCertEnabled' property defined","found":"resource with type 'Microsoft.Web/sites' doesn't have 'clientCertEnabled' property defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"0b39430c-850d-4118-945a-6815eb1d8f87","name":"WorkSpace user volume should be encrypted"},"severity":"MEDIUM","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.Prod.Properties.UserVolumeEncryptionEnabled","fileName":"/harness/KaiMonkey/cft/misc/workspaces-workspace/deploy.json","lineNumber":11,"matchContent":"          \"UserVolumeEncryptionEnabled\" : false,","expected":"Resources.Prod.Properties.UserVolumeEncryptionEnabled should be set to true","found":"Resources.Prod.Properties.UserVolumeEncryptionEnabled is set to false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"778a5405-6a20-49d4-8993-05de321f83c9","name":"App Service HTTPS Only should be enabled"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"resources.name={{[parameters('siteName')]}}.properties","fileName":"/harness/KaiMonkey/arm/mysql-server/azuredeploy.json","lineNumber":137,"matchContent":"            \"properties\": {","expected":"resource with type 'Microsoft.Web/sites' should have the 'httpsOnly' property defined","found":"resource with type 'Microsoft.Web/sites' doesn't have 'httpsOnly' property defined","fileType":"AZURE_RESOURCE_MANAGER","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"5f5a690b-7ff2-4319-bebb-1f29f5a46203","name":"CloudTrail logging should be enabled in all regions - Account level"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myTrail.Properties.IsMultiRegionTrail","fileName":"/harness/KaiMonkey/cft/misc/cloudtrail/deploy.json","lineNumber":9,"matchContent":"        \"IsMultiRegionTrail\": false,","expected":"'Resources.myTrail.Properties.IsMultiRegionTrail' should be true","found":"'Resources.myTrail.Properties.IsMultiRegionTrail' is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"757c765a-10eb-47f4-a82c-f5b182724f36","name":"CloudTrail management events and global service logging should be enabled in all regions - Organization level"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myTrail.Properties.IsMultiRegionTrail","fileName":"/harness/KaiMonkey/cft/misc/cloudtrail/deploy.json","lineNumber":9,"matchContent":"        \"IsMultiRegionTrail\": false,","expected":"'Resources.myTrail.Properties.IsMultiRegionTrail' should be true","found":"'Resources.myTrail.Properties.IsMultiRegionTrail' is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"19b19765-c954-42ee-aac1-d4c95d3927b3","name":"Config configuration aggregator should be enabled on all regions"},"severity":"HIGH","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyConfigurationAggregator2.Properties.AccountAggregationSources","fileName":"/harness/KaiMonkey/cft/config/config-configuration-aggregator/accountaggregation.json","lineNumber":8,"matchContent":"        \"AccountAggregationSources\": [","expected":"'Resources.MyConfigurationAggregator2.Properties.AccountAggregationSources' have all configurations with AllAwsRegions set to true","found":"'Resources.MyConfigurationAggregator2.Properties.AccountAggregationSources' has a configuration with AllAwsRegions set to false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.MyConfigurationAggregator1.Properties.OrganizationAggregationSource.AllAwsRegions","fileName":"/harness/KaiMonkey/cft/config/config-configuration-aggregator/orgaggregation.json","lineNumber":14,"matchContent":"          \"AllAwsRegions\": false","expected":"'Resources.MyConfigurationAggregator1.Properties.OrganizationAggregationSource.AllAwsRegions' is true","found":"'Resources.MyConfigurationAggregator1.Properties.OrganizationAggregationSource.AllAwsRegions' is false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"69def654-1b9e-4dfc-95ba-71af047a73ff","name":"DMS Replication Instance should not be publicly accessible"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.replicator.Properties.PubliclyAccessible","fileName":"/harness/KaiMonkey/cft/dms/replication-instance/deploy.yml","lineNumber":13,"matchContent":"      PubliclyAccessible: true","expected":"Resources.replicator.Properties.PubliclyAccessible should be defined to 'false'","found":"Resources.replicator.Properties.PubliclyAccessible is defined to 'true","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"a65ab340-c994-4598-8b51-677269f9dd80","name":"Database instance encryption at rest should be enabled"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyDB.Properties.StorageEncrypted","fileName":"/harness/KaiMonkey/cft/rds/db-instance/deploy.yml","lineNumber":64,"matchContent":"      StorageEncrypted: false","expected":"Resources.MyDB.Properties.StorageEncrypted should be set to true","found":"Resources.MyDB.Properties.StorageEncrypted is set to false","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"f5e99fd2-a595-4df1-9179-ae367ffdd817","name":"Database instance should not be publicly accessible"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyDB.Properties.PubliclyAccessible","fileName":"/harness/KaiMonkey/cft/rds/db-instance/deploy.yml","lineNumber":67,"matchContent":"      PubliclyAccessible: true","expected":"'Resources.MyDB.Properties.PubliclyAccessible' should be set to false","found":"'Resources.MyDB.Properties.PubliclyAccessible' is set to true","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"bf7dc1e8-6b93-49bf-99be-8eb851dfb711","name":"EC2 Security Group should not allow unrestricted access over ports higher than 1024"},"severity":"HIGH","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[km_rds_sg].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":19,"matchContent":"  ingress {","expected":"Security Group inbound rule should not allow all IP addresses, espically over ports higher than '1024'","found":"aws_security_group[km_rds_sg] ingress rule 'to_port' value is higher than '1024' and allows all IP addreeses ('0.0.0.0/0', '::/0')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Security Group inbound rule should not allow all IP addresses, espically over ports higher than '1024'","found":"aws_security_group[web-app-security-group] ingress rule 'to_port' value is higher than '1024' and allows all IP addreeses ('0.0.0.0/0', '::/0')","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"d51c0f96-b42c-4e60-9be7-b6af0b44f854","name":"EC2 Security Group should restrict ArangoDB access (TCP/UDP:8529)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '8529'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '8529'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"fbbb3178-b05f-4eed-957a-ce7469d98c3f","name":"EC2 Security Group should restrict CIFS access (UDP: 137, 138, 445, TCP: 139, 445)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '137, 138, 139, 445'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '137, 138, 139, 445'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"b913b6dd-e42f-4acc-8525-fc182d0d3755","name":"EC2 Security Group should restrict Cassandra access (TCP:7000,7001,7199,9042,9142,9160)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '7000, 7001, 7199, 9042, 9142, 9160'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '7000, 7001, 7199, 9042, 9142, 9160'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"8776d3ad-df13-412e-8874-1ad5f75b1ed1","name":"EC2 Security Group should restrict CouchDB access (TCP:5984)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '5984'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '5984'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3b98b86d-1d2c-4f4f-81f6-2e10537eaa81","name":"EC2 Security Group should restrict DNS access (TCP:53)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '53'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '53'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"794c884e-94c6-4a5a-87a2-397296d9cf2d","name":"EC2 Security Group should restrict ElasticSearch access (TCP:9200,9300)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '9200, 9300'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '9200, 9300'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3395d3a7-dc34-419d-b51b-22d1bd2c16ba","name":"EC2 Security Group should restrict FTP Data access (TCP:20)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '20'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '20'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"48d171db-9c41-4d0a-bf05-f93e03affb5f","name":"EC2 Security Group should restrict FTP access (TCP:21)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '21'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '21'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ac24cf10-8508-41f4-9c9e-c87c90169272","name":"EC2 Security Group should restrict HTTP access (TCP:80)"},"severity":"HIGH","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.OpenHttpPort.Properties.SecurityGroupIngress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":13,"matchContent":"          ToPort: 80","expected":"Resources.OpenHttpPort.Properties.SecurityGroupIngress[0] should not open the HTTP port (80)","found":"Resources.OpenHttpPort.Properties.SecurityGroupIngress[0] opens the HTTP port (80)","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[km_alb_sg].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":107,"matchContent":"  ingress {","expected":"aws_security_group[km_alb_sg] should restrict access over port: '80'","found":"aws_security_group[km_alb_sg].ingress allows public access over port: '80'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '80'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '80'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"fe685a93-c671-4bfe-bcdb-c16a3181ff30","name":"EC2 Security Group should restrict HTTPS access (TCP:443)"},"severity":"HIGH","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[km_alb_sg].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":107,"matchContent":"  ingress {","expected":"aws_security_group[km_alb_sg] should restrict access over port: '443'","found":"aws_security_group[km_alb_sg].ingress allows public access over port: '443'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '443'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '443'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"501916bd-8df8-436a-a38d-356da23d4047","name":"EC2 Security Group should restrict Kibana access (TCP:5601)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '5601'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '5601'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"d3f2c323-369d-402e-ae0d-3e6c45e83f4f","name":"EC2 Security Group should restrict LDAP access (TCP:389)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '389'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '389'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"12d6e7b4-ffce-4512-b549-0be2e6f47f70","name":"EC2 Security Group should restrict MSSQL access (TCP:1433)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '1433'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '1433'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"cbd97455-a2d3-4dc7-94cf-ce73462f7c2e","name":"EC2 Security Group should restrict MaxDB access (TCP:7210)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '7210'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '7210'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"a20c224e-a514-45b3-9fd4-aa0f70b53289","name":"EC2 Security Group should restrict Memcached access (TCP/UDP:11211)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '11211'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '11211'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"7569c2c2-45f9-4027-82ed-ab8fbbbe1873","name":"EC2 Security Group should restrict MongoDB access (TCP:27017-27020)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '27017, 27018, 27019, 27020'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '27017, 27018, 27019, 27020'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"da9f9ce0-519f-42b7-8dad-7cf5a1c0ed94","name":"EC2 Security Group should restrict MySQL access (TCP:3306)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '3306'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '3306'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c75bcb56-5a9e-4345-865f-0d70ecd6721c","name":"EC2 Security Group should restrict NFS access (TCP:2049)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '2049'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '2049'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ab8e29fa-10d7-4036-824d-005c288ff5df","name":"EC2 Security Group should restrict Neo4J access (TCP:7473,7474, UDP:7473)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '7473, 7474'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '7473, 7474'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"f8a5b9e3-4c7b-43ff-8781-39e6556658b5","name":"EC2 Security Group should restrict NetBIOS access (TCP:137,139, UDP:137,138)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '137, 138, 139'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '137, 138, 139'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"399498b5-5520-4099-8923-76fe3b72409c","name":"EC2 Security Group should restrict Oracle DB access (TCP:1521,1830,2483,2484)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '1521, 1830, 2483, 2484'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '1521, 1830, 2483, 2484'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c4ee94d2-61c9-475b-ac6a-a8384c78f4f9","name":"EC2 Security Group should restrict POP3 access (TCP/UDP:110,995)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '110, 995'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '110, 995'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"0bdb817a-936f-4ba5-abd8-758d90ccf691","name":"EC2 Security Group should restrict PostgreSQL access (TCP:5432)"},"severity":"HIGH","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[km_rds_sg].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":19,"matchContent":"  ingress {","expected":"aws_security_group[km_rds_sg] should restrict access over port: '5432'","found":"aws_security_group[km_rds_sg].ingress allows public access over port: '5432'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '5432'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '5432'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ec36bc9c-e3e3-45b2-b8f9-d9253d38f202","name":"EC2 Security Group should restrict RDP access (TCP:3389)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '3389'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '3389'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"0ec232bc-c606-4eb2-b5f1-db79ab82cdf1","name":"EC2 Security Group should restrict RPC access (TCP:135)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '135'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '135'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"2bcd5bf1-48b8-41d8-98d5-471cebd4810a","name":"EC2 Security Group should restrict Redis access (TCP:6379)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '6379'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '6379'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c8afa652-0327-466f-a946-47ce6ab85e2c","name":"EC2 Security Group should restrict RethinkDB access (TCP:28015,29015,8080, UDP:28015,29015)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '28015, 29015, 8080'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '28015, 29015, 8080'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c73336de-bf27-4d87-9e31-9d87dc717d51","name":"EC2 Security Group should restrict Riak access (TCP:8087,8098)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '8087, 8098'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '8087, 8098'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"ebee874f-7511-4274-a103-033d4ab8f754","name":"EC2 Security Group should restrict SMB access (TCP:445)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '445'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '445'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"00323c9d-4027-442e-b556-bfc9c98914bf","name":"EC2 Security Group should restrict SMTP access (TCP:25)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '25'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '25'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"a01de798-050c-4757-9fe9-8853de37cbe2","name":"EC2 Security Group should restrict SQL Analysis Services access (TCP:2383)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '2383'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '2383'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"580cc798-a4af-4cae-b9c8-a3b0f2242396","name":"EC2 Security Group should restrict SSH access (TCP:22)"},"severity":"HIGH","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.SshRule.Properties.SecurityGroupIngress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":60,"matchContent":"        SecurityGroupIngress:","expected":"None of the Resources.SshRule.Properties.SecurityGroupIngress has port 22","found":"One of the Resources.SshRule.Properties.SecurityGroupIngress has port 22","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '22'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '22'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"e540f631-258d-40d5-8deb-4a17489a8d78","name":"EC2 Security Group should restrict Solr access (TCP:7574,8983)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '7574, 8983'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '7574, 8983'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"d7c4cc79-fbd9-468d-bc01-83bf5ef97580","name":"EC2 Security Group should restrict TCP access"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over TCP","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '0'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"678d5bce-24b6-4d9c-8c2e-7f55483bf1fb","name":"EC2 Security Group should restrict Telnet access (TCP:23)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '23'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '23'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"7bdfc95a-270a-402e-bc34-fe50a4318df5","name":"EC2 Security Group should restrict VNC Listener access (TCP:5500)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '5500'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '5500'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"5f880b55-49b5-4c77-9515-06979ff80981","name":"EC2 Security Group should restrict VNC Server access (TCP: 5800, 5900)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '5800, 5900'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '5800, 5900'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"659a60cd-d9ed-4f0b-9694-11fbb997db12","name":"EC2 Security Group should restrict access to high-risk ports"},"severity":"HIGH","failedResourceCount":65,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[km_alb_sg].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/network/main.tf","lineNumber":107,"matchContent":"  ingress {","expected":"HTTPS (TCP:443) should not be allowed","found":"HTTPS (TCP:443) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[km_rds_sg].ingress","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":19,"matchContent":"  ingress {","expected":"PostgreSQL (TCP:5432) should not be allowed","found":"PostgreSQL (TCP:5432) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"CIFS / SMB (TCP:3020) should not be allowed","found":"CIFS / SMB (TCP:3020) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Cassandra (TCP:7001) should not be allowed","found":"Cassandra (TCP:7001) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Cassandra Client (TCP:9042) should not be allowed","found":"Cassandra Client (TCP:9042) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Cassandra Internode Communication (TCP:7000) should not be allowed","found":"Cassandra Internode Communication (TCP:7000) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Cassandra Monitoring (TCP:7199) should not be allowed","found":"Cassandra Monitoring (TCP:7199) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Cassandra OpsCenter (TCP:61620) should not be allowed","found":"Cassandra OpsCenter (TCP:61620) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Cassandra OpsCenter (TCP:61621) should not be allowed","found":"Cassandra OpsCenter (TCP:61621) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Cassandra OpsCenter Website (TCP:8888) should not be allowed","found":"Cassandra OpsCenter Website (TCP:8888) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Cassandra Thrift (TCP:9160) should not be allowed","found":"Cassandra Thrift (TCP:9160) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"CiscoSecure, WebSM (TCP:9090) should not be allowed","found":"CiscoSecure, WebSM (TCP:9090) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"DNS (TCP:53) should not be allowed","found":"DNS (TCP:53) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Docker (TCP:2375) should not be allowed","found":"Docker (TCP:2375) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Docker (TCP:2376) should not be allowed","found":"Docker (TCP:2376) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Elastic Search (TCP:9200) should not be allowed","found":"Elastic Search (TCP:9200) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Elastic Search (TCP:9300) should not be allowed","found":"Elastic Search (TCP:9300) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"FTP (TCP:20) should not be allowed","found":"FTP (TCP:20) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"FTP (TCP:21) should not be allowed","found":"FTP (TCP:21) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"HDFS NameNode (TCP:8020) should not be allowed","found":"HDFS NameNode (TCP:8020) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"HDFS NameNode WebUI (TCP:50070) should not be allowed","found":"HDFS NameNode WebUI (TCP:50070) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"HDFS NameNode WebUI (TCP:50470) should not be allowed","found":"HDFS NameNode WebUI (TCP:50470) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"HTTP (TCP:80) should not be allowed","found":"HTTP (TCP:80) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"HTTPS (TCP:443) should not be allowed","found":"HTTPS (TCP:443) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Hadoop Name Node (TCP:9000) should not be allowed","found":"Hadoop Name Node (TCP:9000) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Kibana (TCP:5601) should not be allowed","found":"Kibana (TCP:5601) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Known internal web port (TCP:8000) should not be allowed","found":"Known internal web port (TCP:8000) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Known internal web port (TCP:8080) should not be allowed","found":"Known internal web port (TCP:8080) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"LDAP (TCP:389) should not be allowed","found":"LDAP (TCP:389) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"LDAP SSL (TCP:636) should not be allowed","found":"LDAP SSL (TCP:636) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"MSSQL Browser (TCP:1434) should not be allowed","found":"MSSQL Browser (TCP:1434) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"MSSQL Debugger (TCP:135) should not be allowed","found":"MSSQL Debugger (TCP:135) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"MSSQL Server (TCP:1433) should not be allowed","found":"MSSQL Server (TCP:1433) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Memcached (TCP:11211) should not be allowed","found":"Memcached (TCP:11211) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Memcached SSL (TCP:11214) should not be allowed","found":"Memcached SSL (TCP:11214) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Memcached SSL (TCP:11215) should not be allowed","found":"Memcached SSL (TCP:11215) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Microsoft-DS (TCP:445) should not be allowed","found":"Microsoft-DS (TCP:445) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Mongo (TCP:27017) should not be allowed","found":"Mongo (TCP:27017) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Mongo Web Portal (TCP:27018) should not be allowed","found":"Mongo Web Portal (TCP:27018) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"MySQL (TCP:3306) should not be allowed","found":"MySQL (TCP:3306) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"MySQL (TCP:4333) should not be allowed","found":"MySQL (TCP:4333) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"NetBIOS Datagram Service (TCP:138) should not be allowed","found":"NetBIOS Datagram Service (TCP:138) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"NetBIOS Name Service (TCP:137) should not be allowed","found":"NetBIOS Name Service (TCP:137) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"NetBIOS Session Service (TCP:139) should not be allowed","found":"NetBIOS Session Service (TCP:139) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Oracl DB (TCP:1521) should not be allowed","found":"Oracl DB (TCP:1521) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Oracle Auto Data Warehouse (TCP:1522) should not be allowed","found":"Oracle Auto Data Warehouse (TCP:1522) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Oracle DB SSL (TCP:2483) should not be allowed","found":"Oracle DB SSL (TCP:2483) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Oracle DB SSL (TCP:2484) should not be allowed","found":"Oracle DB SSL (TCP:2484) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"POP3 (TCP:110) should not be allowed","found":"POP3 (TCP:110) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"PostgreSQL (TCP:5432) should not be allowed","found":"PostgreSQL (TCP:5432) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Prevalent known internal port (TCP:3000) should not be allowed","found":"Prevalent known internal port (TCP:3000) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Puppet Master (TCP:8140) should not be allowed","found":"Puppet Master (TCP:8140) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Redis (TCP:6379) should not be allowed","found":"Redis (TCP:6379) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Remote Desktop (TCP:3389) should not be allowed","found":"Remote Desktop (TCP:3389) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"SMTP (TCP:25) should not be allowed","found":"SMTP (TCP:25) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"SNMP (TCP:161) should not be allowed","found":"SNMP (TCP:161) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"SQL Server Analysis (TCP:2382) should not be allowed","found":"SQL Server Analysis (TCP:2382) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"SQL Server Analysis (TCP:2383) should not be allowed","found":"SQL Server Analysis (TCP:2383) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"SSH (TCP:22) should not be allowed","found":"SSH (TCP:22) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"SaltStack Master (TCP:4505) should not be allowed","found":"SaltStack Master (TCP:4505) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"SaltStack Master (TCP:4506) should not be allowed","found":"SaltStack Master (TCP:4506) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"Telnet (TCP:23) should not be allowed","found":"Telnet (TCP:23) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"VNC Listener (TCP:5500) should not be allowed","found":"VNC Listener (TCP:5500) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"VNC Server (TCP:5900) should not be allowed","found":"VNC Server (TCP:5900) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"WinRM for HTTP (TCP:5985) should not be allowed","found":"WinRM for HTTP (TCP:5985) is allowed","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c10cbaaa-9325-4e36-b3fc-7f9c84a40cef","name":"EC2 Security Group should restrict access to remote administration ports"},"severity":"HIGH","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.SshRule.Properties.SecurityGroupIngress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":60,"matchContent":"        SecurityGroupIngress:","expected":"None of the Resources.SshRule.Properties.SecurityGroupIngress should have an exposed port","found":"One of the Resources.SshRule.Properties.SecurityGroupIngress has a exposed port (20,21,22,23,115,137,138,2049,3389)","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over ports: '22, 3389'","found":"aws_security_group[web-app-security-group].ingress allows public access over at least one of the ports: '22, 3389'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"a989bed9-8f1a-4db5-a7d2-5cfe15901e86","name":"EC2 Security Group should restrict etcd access (TCP:2379)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '2379'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '2379'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"15d5775d-0a23-4d20-a279-785a64d891dc","name":"EC2 Security Group should restrict mSQL (Mini SQL) access (TCP/UDP: 4333)"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":237,"matchContent":"  ingress {","expected":"aws_security_group[web-app-security-group] should restrict access over port: '4333'","found":"aws_security_group[web-app-security-group].ingress allows public access over port: '4333'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"b2885696-a507-4170-95ab-8a7253efec61","name":"EC2 Security Group should restrict uncommon ports access"},"severity":"HIGH","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress","fileName":"/harness/KaiMonkey/cft/ec2/security-group/deploy.yml","lineNumber":43,"matchContent":"        - IpProtocol: tcp","expected":"Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress[0] shouldn't open unknown ports to the Internet","found":"Resources.UnrestrictedUnknown.Properties.SecurityGroupIngress[0] opens unknown ports to the Internet","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_security_group[web-app-security-group].ingress.cidr_blocks={{0.0.0.0/0}}","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":238,"matchContent":"    cidr_blocks = [\"0.0.0.0/0\"]","expected":"aws_security_group[web-app-security-group].ingress ports are known","found":"aws_security_group[web-app-security-group].ingress ports are unknown and exposed to the entire Internet","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"62aca671-bac6-419c-ab40-aa18bd958044","name":"EC2 instance should not have a public IP address"},"severity":"HIGH","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_instance[km_vm]","fileName":"/harness/KaiMonkey/terraform/aws/modules/compute/main.tf","lineNumber":124,"matchContent":"resource \"aws_instance\" \"km_vm\"{","expected":"'associate_public_ip_address' should be defined and not null","found":"'associate_public_ip_address' is undefined or null","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_instance[web-app-instance].associate_public_ip_address","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":294,"matchContent":"  associate_public_ip_address = \"true\"","expected":"'associate_public_ip_address' should be set to false","found":"'associate_public_ip_address' is true","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_instance[privileged-instance].associate_public_ip_address","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":371,"matchContent":"  associate_public_ip_address = \"true\"","expected":"'associate_public_ip_address' should be set to false","found":"'associate_public_ip_address' is true","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"131f5986-dca5-4794-be1a-c4c389f8c51a","name":"EC2 instance should not launch in EC2-Classic"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.myinstance.Properties","fileName":"/harness/KaiMonkey/cft/ssm/parameters/deploy.yml","lineNumber":16,"matchContent":"    Properties:","expected":"Resources.myinstance.Properties.NetworkInterfaces should be defined","found":"Resources.myinstance.Properties.NetworkInterfaces is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"d0dc7d96-45f1-4512-a880-e05f51106705","name":"EC2 instance should use IMDSv2"},"severity":"HIGH","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_instance[km_vm]","fileName":"/harness/KaiMonkey/terraform/aws/modules/compute/main.tf","lineNumber":124,"matchContent":"resource \"aws_instance\" \"km_vm\"{","expected":"'metadata_options.http_tokens' field should not be set to 'optional'","found":"'metadata_options.http_tokens' field is set to 'optional'","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_instance\" \"example\" {\n  metadata_options {\n    http_tokens = \"required\"\n  }\n}","fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_instance[web-app-instance]","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":292,"matchContent":"resource \"aws_instance\" \"web-app-instance\" {","expected":"'metadata_options.http_tokens' field should not be set to 'optional'","found":"'metadata_options.http_tokens' field is set to 'optional'","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_instance\" \"example\" {\n  metadata_options {\n    http_tokens = \"required\"\n  }\n}","fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_instance[privileged-instance]","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":369,"matchContent":"resource \"aws_instance\" \"privileged-instance\" {","expected":"'metadata_options.http_tokens' field should not be set to 'optional'","found":"'metadata_options.http_tokens' field is set to 'optional'","fileType":"TERRAFORM","remediationInstructions":"resource \"aws_instance\" \"example\" {\n  metadata_options {\n    http_tokens = \"required\"\n  }\n}","fileRemediation":null}]},{"rule":{"id":"6fd5332b-11b0-4546-aca5-eca998733ffd","name":"IAM policy should not allow assume role permission across all services"},"severity":"HIGH","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyPolicy.Properties.PolicyDocument","fileName":"/harness/KaiMonkey/cft/iam/iam-policy/iam-policy.yml","lineNumber":7,"matchContent":"      PolicyDocument:","expected":"'Resources.MyPolicy.Properties.PolicyDocument.Statement' with AssumeRole action should not grant access in all services ('*')","found":"'Resources.MyPolicy.Properties.PolicyDocument.Statement' with AssumeRole action is granting access in all services ('*')","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_iam_policy[privileged-instance-policy].policy","fileName":"/harness/KaiMonkey/terraform/aws/scenarios/ssrf-iam-breach/main.tf","lineNumber":111,"matchContent":"  policy      = \u003c\u003cPOLICY","expected":"'policy.Statement.Resource' should not be '*' with the action 'sts:AssumeRole'(or wildcard containing it), or a Condition should exist.","found":"'policy.Statement.Resource' is '*' and 'policy.Statement.Action' contains 'sts:AssumeRole', or a wildcard allowing it.","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"73b7f631-6cc1-4059-b491-5f5ca46b45b2","name":"Private ECR Repository tag immutability should be enabled"},"severity":"HIGH","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.ecrepo.Properties","fileName":"/harness/KaiMonkey/cft/ecr/repository/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"Resources.ecrepo.Properties.ImageTagMutability should be defined and not null","found":"Resources.ecrepo.Properties.ImageTagMutability is undefined or null","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"Resources.MyRepository.Properties","fileName":"/harness/KaiMonkey/cft/misc/ecr-repository/deploy.json","lineNumber":6,"matchContent":"      \"Properties\": {","expected":"Resources.MyRepository.Properties.ImageTagMutability should be defined and not null","found":"Resources.MyRepository.Properties.ImageTagMutability is undefined or null","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"b7cf19cf-8fc7-4760-860c-55aec1ef2a0e","name":"RDS PostgreSQL instance should be upgraded to protect against local file read vulnerability"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_db_instance[km_db]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":45,"matchContent":"resource \"aws_db_instance\" \"km_db\" {","expected":"'aws_db_instance[km_db].engine_version' should be upgraded.","found":"'aws_db_instance[km_db].engine_version' is vulnerable.","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"b951f602-13a1-4462-a193-ade4e956efd1","name":"REST API Gateway APIs should be accessible only through private API endpoints"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.MyRestApi.Properties.EndpointConfiguration.Types","fileName":"/harness/KaiMonkey/cft/api-gateway/api-gateway-rest-api/deploy.yml","lineNumber":25,"matchContent":"        Types:","expected":"'Resources.MyRestApi.EndpointConfiguration.Types' should contain 'PRIVATE'","found":"'Resources.MyRestApi.EndpointConfiguration.Types' does not contain 'PRIVATE'","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"7ec4c973-cabc-434e-922d-9dbe96bdba6f","name":"Redshift Cluster should be encrypted at rest"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.NoEncryption.Properties","fileName":"/harness/KaiMonkey/cft/misc/redshift_cluster/deploy.yml","lineNumber":37,"matchContent":"    Properties:","expected":"Resources.NoEncryption.Properties.Encrypted should be set","found":"Resources.NoEncryption.Properties.Encrypted is undefined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"b3564746-31dd-44c8-b957-f5fc6bb342ea","name":"Redshift Cluster should not be publicly accessible"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.PubliclyAccessViolation.Properties","fileName":"/harness/KaiMonkey/cft/misc/redshift_cluster/deploy.yml","lineNumber":5,"matchContent":"    Properties:","expected":"'Resources.PubliclyAccessViolation.Properties.PubliclyAccessible' should be defined","found":"'Resources.PubliclyAccessViolation.Properties.PubliclyAccessible' is not defined","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"3a1ff8a0-14c5-4f3e-a25a-6765c2a8aec6","name":"S3 Bucket 'Block Public Access' should be configured to block public access through ACLs"},"severity":"HIGH","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.S3Bucket.Properties.PublicAccessBlockConfiguration","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":10,"matchContent":"      PublicAccessBlockConfiguration:","expected":"'IgnorePublicAcls' should be defined and set to true in the 'PublicAccessBlockConfiguration'%!(EXTRA string=S3Bucket)","found":"'IgnorePublicAcls' is not defined in the 'PublicAccessBlockConfiguration'%!(EXTRA string=S3Bucket)","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket_public_access_block[example]","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/test.tf","lineNumber":13,"matchContent":"resource \"aws_s3_bucket_public_access_block\" \"example\" {","expected":"'ignore_public_acls' should equal 'true'","found":"'ignore_public_acls' is missing","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket_public_access_block[km_public_blob]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":116,"matchContent":"resource \"aws_s3_bucket_public_access_block\" \"km_public_blob\" {","expected":"'ignore_public_acls' should equal 'true'","found":"'ignore_public_acls' is missing","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"64689a7d-7c2e-4bcb-b87a-60482041e3d8","name":"S3 Bucket 'Block Public Access' should be configured to block public access through policies"},"severity":"HIGH","failedResourceCount":3,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.S3Bucket.Properties.PublicAccessBlockConfiguration","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":10,"matchContent":"      PublicAccessBlockConfiguration:","expected":"'RestrictPublicBuckets' should be defined and set to true in the 'PublicAccessBlockConfiguration'%!(EXTRA string=S3Bucket)","found":"'RestrictPublicBuckets' is not defined in the 'PublicAccessBlockConfiguration'%!(EXTRA string=S3Bucket)","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket_public_access_block[example].restrict_public_buckets","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/test.tf","lineNumber":13,"matchContent":"resource \"aws_s3_bucket_public_access_block\" \"example\" {","expected":"'restrict_public_buckets' should equal 'true'","found":"'restrict_public_buckets' is missing","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket_public_access_block[km_public_blob].restrict_public_buckets","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":116,"matchContent":"resource \"aws_s3_bucket_public_access_block\" \"km_public_blob\" {","expected":"'restrict_public_buckets' should equal 'true'","found":"'restrict_public_buckets' is missing","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"bdb6c792-6bba-4952-ad27-95a8ac0683f9","name":"S3 Bucket 'Block Public Access' should be configured to block the creation of new public ACLs"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_s3_bucket_public_access_block[km_public_blob].block_public_acls","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":119,"matchContent":"  block_public_acls   = false","expected":"'block_public_acls' should equal 'true'","found":"'block_public_acls' is equal 'false'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"dea319be-9778-47ef-9098-a22044889202","name":"S3 Bucket 'Block Public Access' should be configured to block the creation of new public policies"},"severity":"HIGH","failedResourceCount":2,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.S3Bucket.Properties.PublicAccessBlockConfiguration","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":10,"matchContent":"      PublicAccessBlockConfiguration:","expected":"'BlockPublicPolicy' should be defined and set to true in the 'PublicAccessBlockConfiguration'%!(EXTRA string=S3Bucket)","found":"'BlockPublicPolicy' is not defined in the 'PublicAccessBlockConfiguration'%!(EXTRA string=S3Bucket)","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null},{"failedPolicies":[],"resourceName":"aws_s3_bucket_public_access_block[km_public_blob].block_public_policy","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":120,"matchContent":"  block_public_policy = false","expected":"'block_public_policy' should equal 'true'","found":"'block_public_policy' is equal 'false'","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"1b9d9a5a-0e67-4bc6-a81e-49b9a6ca55b7","name":"S3 Bucket policy should not allow 'get' actions for all principals"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.SampleBucketPolicy.Properties.PolicyDocument","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":22,"matchContent":"      PolicyDocument:","expected":"Resources.SampleBucketPolicy.Properties.PolicyDocument.Statement should not allow a 'Get' action from all principals","found":"Resources.SampleBucketPolicy.Properties.PolicyDocument.Statement allows a 'Get' action from all principals","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"c20fc347-e9c3-4991-9e41-18229eb2f743","name":"S3 Bucket policy should not allow 'list' actions for all principals"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.SampleBucketPolicy.Properties.PolicyDocument","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":22,"matchContent":"      PolicyDocument:","expected":"Resources.SampleBucketPolicy.Properties.PolicyDocument.Statement should not allow a 'List' action from all principals","found":"Resources.SampleBucketPolicy.Properties.PolicyDocument.Statement allows a 'List' action from all principals","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"433b9213-ab45-47a8-b640-28f6c51ff678","name":"S3 Bucket policy should not allow 'put' actions for all principals"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.SampleBucketPolicy.Properties.PolicyDocument","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":22,"matchContent":"      PolicyDocument:","expected":"Resources.SampleBucketPolicy.Properties.PolicyDocument.Statement should not allow a 'Put' action from all principals","found":"Resources.SampleBucketPolicy.Properties.PolicyDocument.Statement allows a 'Put' action from all principals","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"1b5373f7-7ff9-4252-aada-d596f4a1e8d9","name":"S3 Bucket policy should not allow all actions to all principals"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"Resources.SampleBucketPolicy.Properties.PolicyDocument","fileName":"/harness/KaiMonkey/cft/misc/s3-bucket/deploy.yaml","lineNumber":22,"matchContent":"      PolicyDocument:","expected":"Resources.SampleBucketPolicy.Properties.PolicyDocument.Statement should not allow all actions from all principals","found":"Resources.SampleBucketPolicy.Properties.PolicyDocument.Statement allows all actions from all principals","fileType":"CLOUD_FORMATION","remediationInstructions":null,"fileRemediation":null}]},{"rule":{"id":"4f457e75-b88d-482f-bd71-a7a1b8803bb0","name":"S3 Bucket should have all 'Block Public Access' settings enabled"},"severity":"HIGH","failedResourceCount":1,"failedPolicyMatches":[],"matches":[{"failedPolicies":[],"resourceName":"aws_s3_bucket_public_access_block[km_public_blob]","fileName":"/harness/KaiMonkey/terraform/aws/modules/storage/main.tf","lineNumber":116,"matchContent":"resource \"aws_s3_bucket_public_access_block\" \"km_public_blob\" {","expected":"All the parameters: 'block_public_acls, block_public_policy, ignore_public_acls, restrict_public_buckets' - should be set to 'true'","found":"At least one of the parameters is undefined of false","fileType":"TERRAFORM","remediationInstructions":null,"fileRemediation":null}]}],"scanStatistics":{"infoMatches":6,"lowMatches":82,"mediumMatches":169,"highMatches":152,"criticalMatches":0,"totalMatches":0,"filesFound":164,"filesParsed":164,"queriesLoaded":1388,"queriesExecuted":2497,"queriesExecutionFailed":0},"secrets":null,"fileTypes":["AZURE_RESOURCE_MANAGER","CLOUD_FORMATION","TERRAFORM"]},"reportUrl":"https://app.wiz.io/findings/cicd-scans#%7E%28cicd_scan%7E%278001a31d-f3c1-4e18-af32-20480521522d%29"}